<!DOCTYPE html>
<html>
<head>
    <title>TON Miner PRO</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --primary: #0088cc;
            --secondary: #00cc88;
            --danger: #ff4444;
            --warning: #ffcc00;
            --dark: #0a0a0a;
            --darker: #050505;
            --premium: #ffd700;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, var(--dark), #1a1a2e);
            color: white;
            padding: 20px;
            min-height: 100vh;
            padding-bottom: 80px;
        }
        
        .container {
            max-width: 500px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 25px;
        }
        
        .header h1 {
            color: #00ffff;
            font-size: 2.5em;
            text-shadow: 0 0 15px #00ffff;
            margin-bottom: 5px;
        }
        
        .header .subtitle {
            color: #88ffff;
            opacity: 0.9;
        }
        
        /* –¶–ï–ù–ê */
        .price-container {
            background: linear-gradient(135deg, rgba(0,40,60,0.8), rgba(0,20,40,0.9));
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
            border: 3px solid #00aaff;
            box-shadow: 0 10px 30px rgba(0,170,255,0.3);
            text-align: center;
        }
        
        .price-label {
            color: #88ddff;
            font-size: 0.9em;
            margin-bottom: 5px;
        }
        
        .price {
            font-size: 3.8em;
            color: #00ffaa;
            font-weight: 800;
            margin: 15px 0;
            text-shadow: 0 0 20px #00ffaa;
            transition: all 0.3s;
        }
        
        .chart {
            font-family: monospace;
            font-size: 1.2em;
            color: #ffcc00;
            margin: 15px 0;
            letter-spacing: 2px;
        }
        
        /* –û–°–ù–û–í–ù–ê–Ø –ö–ù–û–ü–ö–ê */
        .main-btn {
            width: 100%;
            padding: 25px;
            font-size: 1.8em;
            font-weight: bold;
            background: linear-gradient(45deg, #ff3366, #cc33ff);
            color: white;
            border: none;
            border-radius: 20px;
            margin: 20px 0;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 10px 25px rgba(255,51,102,0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }
        
        .main-btn:active {
            transform: scale(0.95);
            box-shadow: 0 5px 15px rgba(255,51,102,0.6);
        }
        
        /* –°–¢–ê–¢–ò–°–¢–ò–ö–ê */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: rgba(255,255,255,0.08);
            border-radius: 15px;
            padding: 18px;
            border: 1px solid rgba(255,255,255,0.1);
            transition: all 0.3s;
        }
        
        .stat-card:hover {
            background: rgba(255,255,255,0.12);
            transform: translateY(-3px);
        }
        
        .stat-label {
            color: #88aaff;
            font-size: 0.85em;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: white;
        }
        
        /* –í–ö–õ–ê–î–ö–ò */
        .tabs {
            display: flex;
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            padding: 5px;
            margin: 25px 0;
            overflow-x: auto;
        }
        
        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            background: transparent;
            border: none;
            color: #88aaff;
            font-weight: bold;
            cursor: pointer;
            border-radius: 12px;
            white-space: nowrap;
            min-width: 100px;
        }
        
        .tab.active {
            background: rgba(0,136,204,0.3);
            color: white;
        }
        
        /* –ö–û–ù–¢–ï–ù–¢ –í–ö–õ–ê–î–û–ö */
        .tab-content {
            display: none;
            animation: fadeIn 0.3s;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* –¢–ê–ë–õ–ò–¶–´ (–¢–û–ü –ò –ö–õ–ê–ù–´) */
        .leaderboard {
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            overflow: hidden;
            margin: 15px 0;
        }
        
        .leaderboard-header {
            background: rgba(0,136,204,0.3);
            padding: 15px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
        }
        
        .leaderboard-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 15px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            align-items: center;
        }
        
        .leaderboard-item:nth-child(even) {
            background: rgba(255,255,255,0.03);
        }
        
        .player-rank {
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0,136,204,0.3);
            border-radius: 50%;
            font-weight: bold;
        }
        
        .player-rank.top1 { background: linear-gradient(135deg, gold, orange); color: black; }
        .player-rank.top2 { background: linear-gradient(135deg, silver, gray); color: black; }
        .player-rank.top3 { background: linear-gradient(135deg, #cd7f32, #8b4513); color: white; }
        
        .player-info {
            flex: 1;
            margin-left: 15px;
        }
        
        .player-name {
            font-weight: bold;
            margin-bottom: 3px;
        }
        
        .player-clan {
            font-size: 0.8em;
            color: #88aaff;
        }
        
        .player-ton {
            font-weight: bold;
            color: #00ffaa;
        }
        
        /* –ö–õ–ê–ù–´ */
        .clan-card {
            background: linear-gradient(135deg, rgba(0,100,200,0.25), rgba(0,50,150,0.35));
            border-radius: 18px;
            padding: 20px;
            margin: 15px 0;
            border: 2px solid #0088ff;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .clan-card:hover {
            transform: translateX(5px);
            box-shadow: 0 8px 20px rgba(0,136,255,0.4);
        }
        
        .clan-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .clan-name {
            font-size: 1.3em;
            font-weight: bold;
            color: white;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .clan-level {
            background: rgba(255,204,0,0.2);
            color: #ffcc00;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em;
        }
        
        .clan-stats {
            display: flex;
            gap: 15px;
            margin: 10px 0;
            color: #88ccff;
            font-size: 0.9em;
        }
        
        .clan-join-btn {
            background: linear-gradient(135deg, var(--secondary), #00aa66);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 8px 15px;
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }
        
        .clan-join-btn:active {
            transform: scale(0.95);
        }
        
        .clan-join-btn.joined {
            background: rgba(255,255,255,0.2);
            cursor: default;
        }
        
        .clan-join-btn.leader {
            background: linear-gradient(135deg, var(--warning), #ff9900);
        }
        
        /* PREMIUM –°–¢–ò–õ–ò */
        .premium-badge {
            background: linear-gradient(135deg, var(--warning), #ff9900);
            color: #332200;
            padding: 3px 10px;
            border-radius: 10px;
            font-size: 0.8em;
            font-weight: bold;
            display: inline-block;
        }
        
        .premium-card {
            background: linear-gradient(135deg, rgba(255,204,0,0.15), rgba(255,153,0,0.25));
            border: 2px solid var(--warning);
            position: relative;
            overflow: hidden;
        }
        
        .premium-card::before {
            content: "‚≠ê";
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 1.5em;
            opacity: 0.3;
        }
        
        /* –£–õ–£–ß–®–ï–ù–ò–Ø */
        .upgrade-card {
            background: linear-gradient(135deg, rgba(0,100,200,0.25), rgba(0,50,150,0.35));
            border-radius: 18px;
            padding: 20px;
            margin: 15px 0;
            border: 2px solid #0088ff;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .upgrade-card:hover {
            transform: translateX(8px);
            box-shadow: 0 8px 20px rgba(0,136,255,0.4);
        }
        
        .upgrade-card:active {
            transform: translateX(8px) scale(0.98);
        }
        
        .upgrade-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .upgrade-name {
            font-size: 1.3em;
            font-weight: bold;
            color: white;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .upgrade-count {
            background: rgba(0,255,255,0.2);
            color: #00ffff;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em;
        }
        
        .upgrade-desc {
            color: #88ccff;
            font-size: 0.95em;
            margin-bottom: 15px;
            line-height: 1.4;
        }
        
        .upgrade-price {
            color: #ffcc00;
            font-weight: bold;
            font-size: 1.3em;
            text-align: right;
        }
        
        /* TELEGRAM –ö–ù–û–ü–ö–ò */
        .tg-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 25px 0;
        }
        
        .tg-btn {
            background: linear-gradient(135deg, var(--primary), #0066aa);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 18px 10px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .tg-btn:active {
            transform: scale(0.95);
        }
        
        .tg-btn.premium {
            background: linear-gradient(135deg, var(--warning), #ff9900);
        }
        
        .tg-btn.ton {
            background: linear-gradient(135deg, var(--secondary), #00aa66);
        }
        
        .tg-btn.danger {
            background: linear-gradient(135deg, var(--danger), #cc0000);
        }
        
        /* –¢–£–†–ù–ò–†–´ */
        .tournament-card {
            background: linear-gradient(135deg, rgba(255,0,100,0.15), rgba(200,0,80,0.25));
            border: 2px solid #ff3366;
        }
        
        .tournament-timer {
            font-size: 1.5em;
            font-weight: bold;
            color: #ff3366;
            text-align: center;
            margin: 10px 0;
        }
        
        .tournament-prize {
            text-align: center;
            font-size: 2em;
            color: #00ffaa;
            font-weight: bold;
            margin: 15px 0;
        }
        
        /* –ü–†–û–ì–†–ï–°–° –ë–ê–†–´ */
        .progress-container {
            margin: 15px 0;
        }
        
        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9em;
            color: #88aaff;
        }
        
        .progress-bar {
            height: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ff88, #00ccff);
            border-radius: 5px;
            transition: width 0.5s;
        }
        
        /* –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø */
        .notification {
            position: fixed;
            top: 20px;
            left: 20px;
            right: 20px;
            background: linear-gradient(135deg, #00ff88, #00cc66);
            color: #003311;
            padding: 18px 25px;
            border-radius: 15px;
            font-weight: bold;
            z-index: 1000;
            box-shadow: 0 10px 30px rgba(0,255,136,0.4);
            animation: slideDown 0.3s ease-out;
            display: none;
            text-align: center;
            border: 2px solid #00aa55;
        }
        
        @keyframes slideDown {
            from { transform: translateY(-100px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .notification.error {
            background: linear-gradient(135deg, #ff4444, #cc0000);
            color: white;
            border-color: #ff0000;
        }
        
        .notification.warning {
            background: linear-gradient(135deg, #ffcc00, #ff9900);
            color: #332200;
            border-color: #ff9900;
        }
        
        .notification.premium {
            background: linear-gradient(135deg, var(--warning), #ff9900);
            color: #332200;
            border-color: var(--warning);
        }
        
        /* –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .modal-content {
            background: linear-gradient(135deg, var(--dark), var(--darker));
            border-radius: 20px;
            padding: 25px;
            max-width: 400px;
            width: 100%;
            border: 3px solid var(--primary);
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-title {
            text-align: center;
            font-size: 1.5em;
            margin-bottom: 20px;
            color: #00ffff;
        }
        
        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: white;
            font-size: 1.5em;
            cursor: pointer;
        }
        
        .modal-input {
            width: 100%;
            padding: 15px;
            background: rgba(255,255,255,0.1);
            border: 2px solid var(--primary);
            border-radius: 10px;
            color: white;
            font-size: 1em;
            margin: 10px 0;
        }
        
        .modal-input:focus {
            outline: none;
            border-color: #00ffff;
        }
        
        .modal-textarea {
            width: 100%;
            padding: 15px;
            background: rgba(255,255,255,0.1);
            border: 2px solid var(--primary);
            border-radius: 10px;
            color: white;
            font-size: 1em;
            margin: 10px 0;
            min-height: 100px;
            resize: vertical;
            font-family: inherit;
        }
        
        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .modal-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .modal-btn.primary {
            background: linear-gradient(135deg, var(--primary), #0066aa);
            color: white;
        }
        
        .modal-btn.secondary {
            background: rgba(255,255,255,0.1);
            color: white;
        }
        
        /* –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ */
        @media (max-width: 400px) {
            .price { font-size: 3em; }
            .main-btn { font-size: 1.5em; padding: 20px; }
            .tg-buttons { grid-template-columns: 1fr; }
            .stats-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø -->
    <div class="notification" id="notification"></div>
    
    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –°–û–ó–î–ê–ù–ò–Ø –ö–õ–ê–ù–ê -->
    <div class="modal" id="createClanModal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('createClanModal')">√ó</button>
            <div class="modal-title">üõ°Ô∏è –°–û–ó–î–ê–¢–¨ –ö–õ–ê–ù</div>
            
            <div style="margin-bottom: 20px;">
                <div style="color: #88aaff; margin-bottom: 5px;">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∞–Ω–∞ (3-20 —Å–∏–º–≤–æ–ª–æ–≤):</div>
                <input type="text" class="modal-input" id="clanNameInput" 
                       placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: TON Hunters" maxlength="20">
                
                <div style="color: #88aaff; margin: 15px 0 5px;">–û–ø–∏—Å–∞–Ω–∏–µ –∫–ª–∞–Ω–∞:</div>
                <textarea class="modal-textarea" id="clanDescInput" 
                          placeholder="–û–ø–∏—à–∏—Ç–µ —Ü–µ–ª–∏ –∏ –ø—Ä–∞–≤–∏–ª–∞ –≤–∞—à–µ–≥–æ –∫–ª–∞–Ω–∞..."></textarea>
                
                <div style="color: #88aaff; margin: 15px 0 5px;">–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è:</div>
                <input type="text" class="modal-input" id="clanRequirementsInput" 
                       placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 1000+ TON –¥–æ–±—ã—á–∏">
                
                <div style="color: #ffcc00; margin: 15px 0; padding: 10px; background: rgba(255,204,0,0.1); border-radius: 10px;">
                    üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è: <strong>1,000 TON</strong><br>
                    üë• –ú–∞–∫—Å–∏–º—É–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤: <strong>50</strong><br>
                    üéØ –ë–æ–Ω—É—Å –¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤: <strong>+5% –∫ –¥–æ—Ö–æ–¥—É</strong>
                </div>
            </div>
            
            <div class="modal-buttons">
                <button class="modal-btn secondary" onclick="closeModal('createClanModal')">
                    –û–¢–ú–ï–ù–ê
                </button>
                <button class="modal-btn primary" onclick="confirmCreateClan()">
                    –°–û–ó–î–ê–¢–¨ –ó–ê 1000 TON
                </button>
            </div>
        </div>
    </div>
    
    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ò–ù–§–û–†–ú–ê–¶–ò–ò –û –ö–õ–ê–ù–ï -->
    <div class="modal" id="clanInfoModal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('clanInfoModal')">√ó</button>
            <div class="modal-title" id="clanModalTitle">üõ°Ô∏è –ö–õ–ê–ù</div>
            
            <div id="clanInfoContent">
                <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∞–Ω–µ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
            </div>
        </div>
    </div>
    
    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û PREMIUM -->
    <div class="modal" id="premiumModal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('premiumModal')">√ó</button>
            <div class="modal-title">‚≠ê PREMIUM –ü–û–î–ü–ò–°–ö–ê</div>
            
            <div class="premium-card" style="margin: 15px 0;">
                <div class="clan-header">
                    <div class="clan-name">
                        <span>üëë</span>
                        <span>PREMIUM PRO</span>
                    </div>
                    <div class="clan-level">$9.99</div>
                </div>
                <div style="color: #88ccff; margin: 15px 0;">
                    <div>‚úÖ x3 –¥–æ—Ö–æ–¥ –æ—Ç –∫–ª–∏–∫–æ–≤</div>
                    <div>‚úÖ +500 GH/s –∫ —Ö–µ—à—Ä–µ–π—Ç—É</div>
                    <div>‚úÖ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å 1000 TON</div>
                    <div>‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –≤ —Ç—É—Ä–Ω–∏—Ä–∞—Ö</div>
                    <div>‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∑–Ω–∞—á–æ–∫ Premium</div>
                    <div>‚úÖ –ë–µ–∑ —Ä–µ–∫–ª–∞–º—ã</div>
                </div>
                <button class="tg-btn premium" onclick="buyPremium(9.99)" style="width: 100%;">
                    –ö–£–ü–ò–¢–¨ PREMIUM - $9.99
                </button>
            </div>
            
            <div class="premium-card" style="margin: 15px 0;">
                <div class="clan-header">
                    <div class="clan-name">
                        <span>üíé</span>
                        <span>PREMIUM VIP</span>
                    </div>
                    <div class="clan-level">$19.99</div>
                </div>
                <div style="color: #88ccff; margin: 15px 0;">
                    <div>‚úÖ x5 –¥–æ—Ö–æ–¥ –æ—Ç –∫–ª–∏–∫–æ–≤</div>
                    <div>‚úÖ +2000 GH/s –∫ —Ö–µ—à—Ä–µ–π—Ç—É</div>
                    <div>‚úÖ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å 5000 TON</div>
                    <div>‚úÖ –ê–≤—Ç–æ-–∫–ª–∏–∫–µ—Ä (10/—Å–µ–∫)</div>
                    <div>‚úÖ –í—Å–µ —É–ª—É—á—à–µ–Ω–∏—è x2</div>
                    <div>‚úÖ –õ–∏—á–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä</div>
                </div>
                <button class="tg-btn premium" onclick="buyPremium(19.99)" style="width: 100%;">
                    –ö–£–ü–ò–¢–¨ VIP - $19.99
                </button>
            </div>
        </div>
    </div>
    
    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ü–û–ö–£–ü–ö–ò TON -->
    <div class="modal" id="buyTonModal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('buyTonModal')">√ó</button>
            <div class="modal-title">üí∞ –ö–£–ü–ò–¢–¨ TON</div>
            
            <div style="text-align: center; margin: 20px 0;">
                <div style="font-size: 2em; color: #00ffaa;">1 TON = $2.50</div>
                <div style="color: #88aaff; margin: 10px 0;">–ö—É—Ä—Å –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</div>
            </div>
            
            <div class="upgrade-card" onclick="buyTonPackage(10)">
                <div class="upgrade-header">
                    <div class="upgrade-name">
                        <span>üí∞</span>
                        <span>10 TON</span>
                    </div>
                    <div class="upgrade-price">$25</div>
                </div>
                <div class="upgrade-desc">+5% –±–æ–Ω—É—Å –∫ –ø–æ–∫—É–ø–∫–µ</div>
            </div>
            
            <div class="upgrade-card" onclick="buyTonPackage(50)">
                <div class="upgrade-header">
                    <div class="upgrade-name">
                        <span>üí∞</span>
                        <span>50 TON</span>
                    </div>
                    <div class="upgrade-price">$125</div>
                </div>
                <div class="upgrade-desc">+15% –±–æ–Ω—É—Å –∫ –ø–æ–∫—É–ø–∫–µ</div>
            </div>
            
            <div class="upgrade-card" onclick="buyTonPackage(100)">
                <div class="upgrade-header">
                    <div class="upgrade-name">
                        <span>üí∞</span>
                        <span>100 TON</span>
                    </div>
                    <div class="upgrade-price">$250</div>
                </div>
                <div class="upgrade-desc">+30% –±–æ–Ω—É—Å –∫ –ø–æ–∫—É–ø–∫–µ</div>
            </div>
            
            <button class="tg-btn ton" onclick="openPayment()" style="width: 100%; margin-top: 20px;">
                üí≥ –û–¢–ö–†–´–¢–¨ –ö–û–®–ï–õ–ï–ö –î–õ–Ø –û–ü–õ–ê–¢–´
            </button>
        </div>
    </div>
    
    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –†–ï–§–ï–†–ê–õ–û–í -->
    <div class="modal" id="referralModal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('referralModal')">√ó</button>
            <div class="modal-title">üë• –ü–†–ò–ì–õ–ê–°–ò–¢–¨ –î–†–£–ó–ï–ô</div>
            
            <div style="text-align: center; margin: 20px 0;">
                <div style="font-size: 3em; color: #00ffaa;">+10%</div>
                <div style="color: #88aaff;">–æ—Ç –¥–æ—Ö–æ–¥–∞ –∫–∞–∂–¥–æ–≥–æ –¥—Ä—É–≥–∞</div>
            </div>
            
            <div style="background: rgba(0,136,204,0.2); padding: 15px; border-radius: 15px; margin: 15px 0;">
                <div style="color: #88ddff; margin-bottom: 10px;">–í–∞—à–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞:</div>
                <div style="background: rgba(0,0,0,0.3); padding: 10px; border-radius: 10px; word-break: break-all; font-family: monospace;"
                     id="referralLink">
                    –ó–∞–≥—Ä—É–∑–∫–∞...
                </div>
                <button class="tg-btn" onclick="copyReferralLink()" style="width: 100%; margin-top: 10px;">
                    üìã –°–ö–û–ü–ò–†–û–í–ê–¢–¨ –°–°–´–õ–ö–£
                </button>
            </div>
            
            <div style="margin: 20px 0;">
                <div style="color: #88aaff; margin-bottom: 10px;">–í–∞—à–∏ —Ä–µ—Ñ–µ—Ä–∞–ª—ã:</div>
                <div id="referralList">
                    <!-- –°–ø–∏—Å–æ–∫ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">üë• –ü—Ä–∏–≥–ª–∞—à–µ–Ω–æ</div>
                    <div class="stat-value" id="referralCount">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">üí∞ –ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ</div>
                    <div class="stat-value" id="referralEarned">0 TON</div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="container">
        <!-- –®–ê–ü–ö–ê -->
        <div class="header">
            <h1>üöÄ TON MINER PRO</h1>
            <div class="subtitle">–ö–∞—á–∞–π —Ü–µ–Ω—É TON –¥–æ –ª—É–Ω—ã!</div>
        </div>
        
        <!-- –ò–ù–§–û –ò–ì–†–û–ö–ê -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">üë§ –ò–≥—Ä–æ–∫</div>
                <div class="stat-value" id="playerName">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">üí∞ –ë–∞–ª–∞–Ω—Å</div>
                <div class="stat-value" id="balance">0 TON</div>
            </div>
        </div>
        
        <!-- –¶–ï–ù–ê TON -->
        <div class="price-container">
            <div class="price-label">üí∞ –¶–ï–ù–ê TON</div>
            <div class="price" id="price">$1.00</div>
            <div class="chart" id="chart">[‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ]</div>
            <div class="price-label">üìà +<span id="growthRate">0.01</span>/–∫–ª–∏–∫</div>
        </div>
        
        <!-- –û–°–ù–û–í–ù–ê–Ø –ö–ù–û–ü–ö–ê -->
        <button class="main-btn" onclick="clickTon()">
            <span>üöÄ</span>
            <span>–ù–ê–ö–ê–ß–ê–¢–¨ TON</span>
        </button>
        
        <!-- –í–ö–õ–ê–î–ö–ò -->
        <div class="tabs" id="tabs">
            <button class="tab active" onclick="switchTab('upgrades')">‚ö° –£–õ–£–ß–®–ï–ù–ò–Ø</button>
            <button class="tab" onclick="switchTab('top')">üèÜ –¢–û–ü –ò–ì–†–û–ö–ò</button>
            <button class="tab" onclick="switchTab('tournaments')">‚öîÔ∏è –¢–£–†–ù–ò–†–´</button>
            <button class="tab" onclick="switchTab('clans')">üë• –ö–õ–ê–ù–´</button>
        </div>
        
        <!-- –í–ö–õ–ê–î–ö–ê: –£–õ–£–ß–®–ï–ù–ò–Ø -->
        <div class="tab-content active" id="upgradesTab">
            <!-- –ë–ê–ó–û–í–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø -->
            <div class="upgrade-card" onclick="buyUpgrade('gpu')">
                <div class="upgrade-header">
                    <div class="upgrade-name">
                        <span>üíª</span>
                        <span>–í–∏–¥–µ–æ–∫–∞—Ä—Ç–∞</span>
                    </div>
                    <div class="upgrade-count" id="gpuCount">0</div>
                </div>
                <div class="upgrade-desc">
                    +5 GH/s, +0.3% –∫ —Ü–µ–Ω–µ –∑–∞ –∫–ª–∏–∫
                </div>
                <div class="upgrade-price" id="gpuPrice">50 TON</div>
            </div>
            
            <div class="upgrade-card" onclick="buyUpgrade('farm')">
                <div class="upgrade-header">
                    <div class="upgrade-name">
                        <span>üåê</span>
                        <span>–ú–∞–π–Ω–∏–Ω–≥-—Ñ–µ—Ä–º–∞</span>
                    </div>
                    <div class="upgrade-count" id="farmCount">0</div>
                </div>
                <div class="upgrade-desc">
                    +25 GH/s –∞–≤—Ç–æ-–¥–æ–±—ã—á–∏, +1% –∫ —Ü–µ–Ω–µ
                </div>
                <div class="upgrade-price" id="farmPrice">250 TON</div>
            </div>
            
            <!-- –ü–†–û–î–í–ò–ù–£–¢–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø -->
            <div class="upgrade-card" onclick="buyUpgrade('bot')" id="botUpgrade">
                <div class="upgrade-header">
                    <div class="upgrade-name">
                        <span>ü§ñ</span>
                        <span>–¢–æ—Ä–≥–æ–≤—ã–π –±–æ—Ç</span>
                    </div>
                    <div class="upgrade-count" id="botCount">0</div>
                </div>
                <div class="upgrade-desc">
                    x2 –∫ —Å–∏–ª–µ –∫–ª–∏–∫–æ–≤, –∞–≤—Ç–æ-—Ä–æ—Å—Ç —Ü–µ–Ω—ã
                </div>
                <div class="upgrade-price" id="botPrice">500 TON</div>
            </div>
            
            <div class="upgrade-card" onclick="buyUpgrade('exchange')" id="exchangeUpgrade">
                <div class="upgrade-header">
                    <div class="upgrade-name">
                        <span>üè¶</span>
                        <span>–ö—Ä–∏–ø—Ç–æ–±–∏—Ä–∂–∞</span>
                    </div>
                    <div class="upgrade-count" id="exchangeCount">0</div>
                </div>
                <div class="upgrade-desc">
                    x3 –∫ –∞–≤—Ç–æ-–¥–æ–±—ã—á–µ, +5% –∫ —Ü–µ–Ω–µ
                </div>
                <div class="upgrade-price" id="exchangePrice">2,000 TON</div>
            </div>
            
            <!-- –≠–õ–ò–¢–ù–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø -->
            <div class="upgrade-card" onclick="buyUpgrade('satellite')" id="satelliteUpgrade">
                <div class="upgrade-header">
                    <div class="upgrade-name">
                        <span>üõ∞Ô∏è</span>
                        <span>–°–ø—É—Ç–Ω–∏–∫–æ–≤—ã–π –º–∞–π–Ω–∏–Ω–≥</span>
                    </div>
                    <div class="upgrade-count" id="satelliteCount">0</div>
                </div>
                <div class="upgrade-desc">
                    x10 –∫–æ –≤—Å–µ–º –¥–æ—Ö–æ–¥–∞–º, VIP —Å—Ç–∞—Ç—É—Å
                </div>
                <div class="upgrade-price" id="satellitePrice">10,000 TON</div>
            </div>
        </div>
        
        <!-- –í–ö–õ–ê–î–ö–ê: –¢–û–ü –ò–ì–†–û–ö–ò -->
        <div class="tab-content" id="topTab">
            <div class="leaderboard">
                <div class="leaderboard-header">
                    <span>üèÜ –¢–û–ü –ò–ì–†–û–ö–û–í –ü–û –î–û–ë–´–ß–ï TON</span>
                    <span>TON</span>
                </div>
                <div id="topPlayers">
                    <!-- –¢–æ–ø –∏–≥—Ä–æ–∫–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                </div>
            </div>
            
            <div style="text-align: center; margin: 20px 0;">
                <div style="color: #88aaff; margin-bottom: 10px;">–í–∞—à–µ –º–µ—Å—Ç–æ –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ:</div>
                <div style="font-size: 2em; color: #00ffaa; font-weight: bold;" id="playerRank">#0</div>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">üìä –í—Å–µ–≥–æ –¥–æ–±—ã—Ç–æ</div>
                    <div class="stat-value" id="totalMined">0 TON</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">üöÄ –õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</div>
                    <div class="stat-value" id="bestResult">$0.00</div>
                </div>
            </div>
        </div>
        
        <!-- –í–ö–õ–ê–î–ö–ê: –¢–£–†–ù–ò–†–´ -->
        <div class="tab-content" id="tournamentsTab">
            <div class="tournament-card">
                <div style="text-align: center; padding: 20px;">
                    <div style="font-size: 1.5em; color: #ff3366; font-weight: bold; margin-bottom: 10px;">
                        ‚öîÔ∏è –ê–ö–¢–ò–í–ù–´–ô –¢–£–†–ù–ò–†
                    </div>
                    <div class="tournament-timer" id="tournamentTimer">24:00:00</div>
                    <div style="color: #88aaff;">–î–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è</div>
                </div>
                
                <div class="tournament-prize" id="tournamentPrize">5,000 TON</div>
                <div style="text-align: center; color: #88aaff; margin-bottom: 20px;">
                    –ü—Ä–∏–∑–æ–≤–æ–π —Ñ–æ–Ω–¥
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">üéØ –£—á–∞—Å—Ç–Ω–∏–∫–æ–≤</div>
                        <div class="stat-value" id="tournamentPlayers">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">üèÜ –í–∞—à–µ –º–µ—Å—Ç–æ</div>
                        <div class="stat-value" id="tournamentPosition">#0</div>
                    </div>
                </div>
                
                <button class="tg-btn" onclick="joinTournament()" style="width: 100%; margin: 15px 0;">
                    <span>‚öîÔ∏è</span>
                    <span>–£–ß–ê–°–¢–í–û–í–ê–¢–¨ (50 TON)</span>
                </button>
            </div>
            
            <div style="margin-top: 20px;">
                <div style="color: #88aaff; margin-bottom: 10px;">üéÆ –ü–†–ê–í–ò–õ–ê –¢–£–†–ù–ò–†–ê:</div>
                <div style="color: #aaa; font-size: 0.9em; line-height: 1.4;">
                    1. –¢—É—Ä–Ω–∏—Ä –¥–ª–∏—Ç—Å—è 24 —á–∞—Å–∞<br>
                    2. –ü–æ–±–µ–∂–¥–∞–µ—Ç –∏–≥—Ä–æ–∫ —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –¥–æ—Ö–æ–¥–æ–º<br>
                    3. –ü—Ä–∏–∑–æ–≤–æ–π —Ñ–æ–Ω–¥ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –º–µ–∂–¥—É —Ç–æ–ø-3<br>
                    4. Premium –∏–≥—Ä–æ–∫–∏ –ø–æ–ª—É—á–∞—é—Ç +20% –±–æ–Ω—É—Å<br>
                    5. –ú–æ–∂–Ω–æ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è
                </div>
            </div>
        </div>
        
        <!-- –í–ö–õ–ê–î–ö–ê: –ö–õ–ê–ù–´ -->
        <div class="tab-content" id="clansTab">
            <div id="clansList">
                <!-- –°–ø–∏—Å–æ–∫ –∫–ª–∞–Ω–æ–≤ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
            </div>
            
            <div class="clan-card" onclick="openModal('createClanModal')">
                <div class="clan-header">
                    <div class="clan-name">
                        <span>üõ°Ô∏è</span>
                        <span>–°–û–ó–î–ê–¢–¨ –ù–û–í–´–ô –ö–õ–ê–ù</span>
                    </div>
                    <div class="clan-level">1,000 TON</div>
                </div>
                <div class="clan-stats">
                    <div>üë• –ú–∞–∫—Å: 50 –∏–≥—Ä–æ–∫–æ–≤</div>
                    <div>üí∞ –ë–æ–Ω—É—Å: +5% –∫ –¥–æ—Ö–æ–¥—É</div>
                </div>
                <div style="color: #88ccff; margin: 10px 0;">
                    –°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π –∫–ª–∞–Ω –∏ –ø—Ä–∏–≥–ª–∞—à–∞–π—Ç–µ –¥—Ä—É–∑–µ–π –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–Ω–æ–π –¥–æ–±—ã—á–∏ TON
                </div>
            </div>
        </div>
        
        <!-- –ü–†–û–ì–†–ï–°–° –ò–ì–†–´ -->
        <div class="progress-container">
            <div class="progress-label">
                <span>üèÜ –¶–µ–ª—å: $1,000</span>
                <span id="goalProgress">0.1%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="goalBar" style="width: 0.1%"></div>
            </div>
        </div>
        
        <!-- TELEGRAM –ö–ù–û–ü–ö–ò -->
        <div class="tg-buttons">
            <button class="tg-btn ton" onclick="openModal('buyTonModal')">
                <span>üí∞</span>
                <span>–ö—É–ø–∏—Ç—å TON</span>
            </button>
            
            <button class="tg-btn" onclick="openModal('referralModal')">
                <span>üë•</span>
                <span>–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å</span>
            </button>
            
            <button class="tg-btn premium" onclick="openModal('premiumModal')">
                <span>‚≠ê</span>
                <span>Premium</span>
            </button>
            
            <button class="tg-btn" onclick="dailyBonus()">
                <span>üéÅ</span>
                <span>–ë–æ–Ω—É—Å</span>
            </button>
        </div>
        
        <!-- –°–¢–ê–¢–ò–°–¢–ò–ö–ê -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">‚ö° –•–µ—à—Ä–µ–π—Ç</div>
                <div class="stat-value" id="hashrate">1 GH/s</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">üë• –î—Ä—É–∑–µ–π</div>
                <div class="stat-value" id="friends">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">üìä –£—Ä–æ–≤–µ–Ω—å</div>
                <div class="stat-value" id="level">1</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">ü§ñ –ê–≤—Ç–æ-–¥–æ–±—ã—á–∞</div>
                <div class="stat-value" id="autoIncome">0/—Å–µ–∫</div>
            </div>
        </div>
        
        <!-- –§–£–¢–ï–† -->
        <div style="text-align: center; margin-top: 30px; color: #88aaff; font-size: 0.9em;">
            üéÆ –ò–≥—Ä–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –≤–∞—à–µ–º Telegram –∞–∫–∫–∞—É–Ω—Ç–µ
        </div>
    </div>

    <script>
        // ============ –¢–ï–õ–ï–ì–†–ê–ú –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ============
        let tg = window.Telegram.WebApp;
        let isTelegram = false;
        let userId = null;
        let userName = null;
        let referralCode = null;
        
        if (tg) {
            isTelegram = true;
            tg.expand();
            tg.ready();
            tg.enableClosingConfirmation();
            console.log('‚úÖ –ó–∞–ø—É—â–µ–Ω–æ –≤ Telegram');
            
            // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const user = tg.initDataUnsafe.user;
            if (user) {
                userId = user.id.toString();
                userName = user.first_name || '–ò–≥—Ä–æ–∫';
                document.getElementById('playerName').textContent = userName;
                
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥
                referralCode = `ref_${userId}`;
            }
        } else {
            console.log('üåê –ó–∞–ø—É—â–µ–Ω–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ');
            userId = 'browser_' + Math.random().toString(36).substr(2, 9);
            userName = '–ò–≥—Ä–æ–∫';
            document.getElementById('playerName').textContent = userName;
            referralCode = `ref_${userId}`;
        }
        
        // ============ –ò–ì–†–ê ============
        let game = {
            version: '3.1',
            price: 1.00,
            balance: 0,
            hashrate: 1,
            level: 1,
            friends: 0,
            totalClicks: 0,
            totalEarned: 0,
            totalMined: 0,
            bestPrice: 1.00,
            
            upgrades: {
                gpu: 0,
                farm: 0,
                bot: false,
                exchange: false,
                satellite: false
            },
            
            premium: {
                active: false,
                type: null,
                expires: null
            },
            
            tournament: {
                joined: false,
                score: 0,
                position: 0,
                prize: 0,
                endTime: null
            },
            
            clan: {
                id: null,
                name: '',
                role: null,
                joined: false,
                memberSince: null
            },
            
            referrals: {
                count: 0,
                earned: 0,
                list: []
            },
            
            purchases: {
                totalSpent: 0,
                lastPurchase: null,
                tonBought: 0
            }
        };
        
        // ============ –°–ò–°–¢–ï–ú–ê –ö–õ–ê–ù–û–í ============
        let clans = []; // –ù–∞—á–∏–Ω–∞–µ–º —Å –ø—É—Å—Ç–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ –∫–ª–∞–Ω–æ–≤
        let clanMembers = {}; // –•—Ä–∞–Ω–∏—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∫–ª–∞–Ω–æ–≤
        
        // ============ –¢–û–ü –ò–ì–†–û–ö–ò ============
        let topPlayers = [];
        
        // ============ –ó–ê–ì–†–£–ó–ö–ê –ò –°–û–•–†–ê–ù–ï–ù–ò–ï ============
        function loadGame() {
            if (isTelegram) {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–≥—Ä—É
                tg.CloudStorage.getItem('tonMinerPro_v3', (err, data) => {
                    if (data) {
                        try {
                            const saved = JSON.parse(data);
                            if (saved.version === game.version) {
                                game = saved;
                                console.log('‚úÖ –ò–≥—Ä–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏–∑ Telegram Cloud');
                            }
                        } catch(e) {
                            console.log('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–≥—Ä—ã');
                        }
                    }
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–ª–∞–Ω—ã (–æ–±—â–∏–µ –¥–ª—è –≤—Å–µ—Ö)
                    tg.CloudStorage.getItem('clans_data', (err, data) => {
                        if (data) {
                            try {
                                const saved = JSON.parse(data);
                                clans = saved.clans || [];
                                clanMembers = saved.clanMembers || {};
                                console.log('‚úÖ –ö–ª–∞–Ω—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
                            } catch(e) {
                                console.log('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–ª–∞–Ω–æ–≤');
                            }
                        }
                        
                        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–ø –∏–≥—Ä–æ–∫–æ–≤
                        tg.CloudStorage.getItem('top_players', (err, data) => {
                            if (data) {
                                try {
                                    topPlayers = JSON.parse(data);
                                    console.log('‚úÖ –¢–æ–ø –∏–≥—Ä–æ–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
                                } catch(e) {
                                    console.log('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–ø –∏–≥—Ä–æ–∫–æ–≤');
                                }
                            }
                            
                            initGame();
                        });
                    });
                });
            } else {
                // –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞
                const savedGame = localStorage.getItem('tonMinerPro_v3');
                if (savedGame) {
                    try {
                        const data = JSON.parse(savedGame);
                        if (data.version === game.version) {
                            game = data;
                            console.log('‚úÖ –ò–≥—Ä–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏–∑ localStorage');
                        }
                    } catch(e) {}
                }
                
                const savedClans = localStorage.getItem('clans_data');
                if (savedClans) {
                    try {
                        const data = JSON.parse(savedClans);
                        clans = data.clans || [];
                        clanMembers = data.clanMembers || {};
                        console.log('‚úÖ –ö–ª–∞–Ω—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
                    } catch(e) {}
                }
                
                const savedTop = localStorage.getItem('top_players');
                if (savedTop) {
                    try {
                        topPlayers = JSON.parse(savedTop);
                        console.log('‚úÖ –¢–æ–ø –∏–≥—Ä–æ–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
                    } catch(e) {}
                }
                
                initGame();
            }
        }
        
        function saveGame() {
            if (isTelegram) {
                tg.CloudStorage.setItem('tonMinerPro_v3', JSON.stringify(game));
            } else {
                localStorage.setItem('tonMinerPro_v3', JSON.stringify(game));
            }
        }
        
        function saveClans() {
            const data = {
                clans: clans,
                clanMembers: clanMembers,
                lastUpdate: new Date().toISOString()
            };
            
            if (isTelegram) {
                tg.CloudStorage.setItem('clans_data', JSON.stringify(data));
            } else {
                localStorage.setItem('clans_data', JSON.stringify(data));
            }
        }
        
        function saveTopPlayers() {
            if (isTelegram) {
                tg.CloudStorage.setItem('top_players', JSON.stringify(topPlayers));
            } else {
                localStorage.setItem('top_players', JSON.stringify(topPlayers));
            }
        }
        
        // ============ –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò ============
        function initGame() {
            updateUI();
            updateGoal();
            unlockUpgrades();
            updateTopPlayers();
            updateClansList();
            updateReferralInfo();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ-—Ñ–µ—Ä–º—É –µ—Å–ª–∏ –µ—Å—Ç—å
            if (game.upgrades.farm > 0) {
                startAutoFarm();
            }
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ-–∫–ª–∏–∫–∏ –µ—Å–ª–∏ –µ—Å—Ç—å –±–æ—Ç
            if (game.upgrades.bot) {
                startAutoClicks();
            }
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ-—Ç—Ä–µ–π–¥–∏–Ω–≥ –µ—Å–ª–∏ –µ—Å—Ç—å –±–∏—Ä–∂–∞
            if (game.upgrades.exchange) {
                startAutoTrading();
            }
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç—É—Ä–Ω–∏—Ä–Ω—ã–π —Ç–∞–π–º–µ—Ä
            startTournamentTimer();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
            setInterval(updateUI, 1000);
            setInterval(updateTournamentInfo, 5000);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ø –∏–≥—Ä–æ–∫–æ–≤
            updatePlayerInTop();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
            setTimeout(() => {
                showNotification('üéÆ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ TON Miner PRO v3.1!', 'success');
            }, 1000);
        }
        
        function clickTon() {
            game.totalClicks++;
            
            // –ë–∞–∑–æ–≤–∞—è —Å–∏–ª–∞ –∫–ª–∏–∫–∞
            let clickPower = 0.01;
            let hashPower = game.hashrate;
            
            // –ë–æ–Ω—É—Å—ã –æ—Ç —É–ª—É—á—à–µ–Ω–∏–π
            clickPower += game.upgrades.gpu * 0.003;
            hashPower += game.upgrades.gpu * 5;
            
            // –ë–æ–Ω—É—Å –æ—Ç Premium
            if (game.premium.active) {
                if (game.premium.type === 'pro') {
                    clickPower *= 3;
                    hashPower *= 1.5;
                } else if (game.premium.type === 'vip') {
                    clickPower *= 5;
                    hashPower *= 2;
                }
            }
            
            if (game.upgrades.bot) {
                clickPower *= 2;
            }
            
            if (game.upgrades.exchange) {
                clickPower *= 1.5;
            }
            
            if (game.upgrades.satellite) {
                clickPower *= 10;
                hashPower *= 10;
            }
            
            // –ë–æ–Ω—É—Å –æ—Ç –∫–ª–∞–Ω–∞
            if (game.clan.joined) {
                clickPower *= 1.05;
                hashPower *= 1.05;
            }
            
            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ü–µ–Ω—É TON
            game.price += clickPower + (Math.random() * 0.01);
            if (game.price > game.bestPrice) {
                game.bestPrice = game.price;
            }
            
            // –î–æ–±—ã–≤–∞–µ–º TON
            const mined = hashPower * (1 + game.friends * 0.1);
            game.balance += mined;
            game.totalEarned += mined;
            game.totalMined += mined;
            
            // –°–ª—É—á–∞–π–Ω—ã–µ –∏–≤–µ–Ω—Ç—ã
            checkRandomEvents();
            
            updateUI();
            updateGoal();
            updatePlayerInTop();
            saveGame();
            
            // –ê–Ω–∏–º–∞—Ü–∏—è
            const priceEl = document.getElementById('price');
            priceEl.style.transform = 'scale(1.15)';
            setTimeout(() => priceEl.style.transform = 'scale(1)', 150);
        }
        
        // ============ –£–õ–£–ß–®–ï–ù–ò–Ø ============
        function buyUpgrade(type) {
            let price = 0;
            let message = '';
            let canBuy = false;
            
            switch(type) {
                case 'gpu':
                    price = Math.floor(50 * Math.pow(1.25, game.upgrades.gpu));
                    if (game.balance >= price) {
                        game.balance -= price;
                        game.upgrades.gpu++;
                        game.hashrate += 5;
                        message = 'üíª –í–∏–¥–µ–æ–∫–∞—Ä—Ç–∞ –∫—É–ø–ª–µ–Ω–∞! +5 GH/s';
                        canBuy = true;
                    }
                    break;
                    
                case 'farm':
                    price = Math.floor(250 * Math.pow(1.3, game.upgrades.farm));
                    if (game.balance >= price) {
                        game.balance -= price;
                        game.upgrades.farm++;
                        message = 'üåê –ú–∞–π–Ω–∏–Ω–≥-—Ñ–µ—Ä–º–∞ –∫—É–ø–ª–µ–Ω–∞! –ê–≤—Ç–æ-–¥–æ–±—ã—á–∞ –∑–∞–ø—É—â–µ–Ω–∞';
                        canBuy = true;
                        startAutoFarm();
                    }
                    break;
                    
                case 'bot':
                    price = 500;
                    if (!game.upgrades.bot && game.balance >= price) {
                        game.balance -= price;
                        game.upgrades.bot = true;
                        message = 'ü§ñ –¢–æ—Ä–≥–æ–≤—ã–π –±–æ—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω! –ö–ª–∏–∫–∏ x2!';
                        canBuy = true;
                        startAutoClicks();
                    }
                    break;
                    
                case 'exchange':
                    price = 2000;
                    if (!game.upgrades.exchange && game.balance >= price) {
                        game.balance -= price;
                        game.upgrades.exchange = true;
                        message = 'üè¶ –ö—Ä–∏–ø—Ç–æ–±–∏—Ä–∂–∞ –∫—É–ø–ª–µ–Ω–∞! –î–æ—Ö–æ–¥ x3!';
                        canBuy = true;
                        startAutoTrading();
                        unlockUpgrades();
                    }
                    break;
                    
                case 'satellite':
                    price = 10000;
                    if (!game.upgrades.satellite && game.balance >= price) {
                        game.balance -= price;
                        game.upgrades.satellite = true;
                        message = 'üõ∞Ô∏è –°–ü–£–¢–ù–ò–ö –ê–ö–¢–ò–í–ò–†–û–í–ê–ù! –í–°–ï –î–û–•–û–î–´ x10!';
                        canBuy = true;
                        unlockUpgrades();
                    }
                    break;
            }
            
            if (canBuy) {
                showNotification(message, 'success');
                updateUI();
                saveGame();
                unlockUpgrades();
            } else if (price > 0) {
                showNotification(`‚ùå –ù—É–∂–Ω–æ –µ—â—ë ${Math.ceil(price - game.balance)} TON`, 'error');
            }
        }
        
        function unlockUpgrades() {
            // –ë–æ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω —Å $5
            if (game.price >= 5 && !game.upgrades.bot) {
                document.getElementById('botUpgrade').style.display = 'block';
            }
            
            // –ë–∏—Ä–∂–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Å $20
            if (game.price >= 20 && !game.upgrades.exchange) {
                document.getElementById('exchangeUpgrade').style.display = 'block';
            }
            
            // –°–ø—É—Ç–Ω–∏–∫ –¥–æ—Å—Ç—É–ø–µ–Ω —Å $50
            if (game.price >= 50 && !game.upgrades.satellite) {
                document.getElementById('satelliteUpgrade').style.display = 'block';
            }
        }
        
        // ============ –ê–í–¢–û-–°–ò–°–¢–ï–ú–´ ============
        let autoFarmInterval;
        function startAutoFarm() {
            if (autoFarmInterval) clearInterval(autoFarmInterval);
            
            autoFarmInterval = setInterval(() => {
                if (game.upgrades.farm > 0) {
                    let farmPower = game.upgrades.farm * 25;
                    
                    if (game.upgrades.exchange) farmPower *= 3;
                    if (game.upgrades.satellite) farmPower *= 10;
                    if (game.premium.active) farmPower *= 2;
                    
                    game.balance += farmPower;
                    game.totalEarned += farmPower;
                    game.totalMined += farmPower;
                    updateUI();
                    updatePlayerInTop();
                    saveGame();
                }
            }, 1000);
        }
        
        let autoClickInterval;
        function startAutoClicks() {
            if (autoClickInterval) clearInterval(autoClickInterval);
            
            autoClickInterval = setInterval(() => {
                if (game.upgrades.bot) {
                    // –ò–º–∏—Ç–∞—Ü–∏—è 5 –∫–ª–∏–∫–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É
                    for (let i = 0; i < 5; i++) {
                        game.totalClicks++;
                        game.price += 0.002;
                        game.balance += game.hashrate * 0.2;
                        game.totalMined += game.hashrate * 0.2;
                    }
                    updateUI();
                    updatePlayerInTop();
                    saveGame();
                }
            }, 1000);
        }
        
        let autoTradeInterval;
        function startAutoTrading() {
            if (autoTradeInterval) clearInterval(autoTradeInterval);
            
            autoTradeInterval = setInterval(() => {
                if (game.upgrades.exchange) {
                    // –°–ª—É—á–∞–π–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è
                    const profit = Math.random() * 10 - 3; // -3 –¥–æ +7 TON
                    game.balance += profit;
                    game.totalMined += profit;
                    
                    if (profit > 5) {
                        showNotification(`üìà –£–¥–∞—á–Ω–∞—è —Å–¥–µ–ª–∫–∞: +${profit.toFixed(2)} TON`, 'success');
                    }
                    
                    updateUI();
                    updatePlayerInTop();
                    saveGame();
                }
            }, 5000);
        }
        
        // ============ –°–ò–°–¢–ï–ú–ê –ö–õ–ê–ù–û–í ============
        function updateClansList() {
            const container = document.getElementById('clansList');
            container.innerHTML = '';
            
            if (clans.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 30px; color: #88aaff;">
                        <div style="font-size: 3em; margin-bottom: 20px;">üõ°Ô∏è</div>
                        <div style="font-size: 1.2em; font-weight: bold; margin-bottom: 10px;">
                            –ö–õ–ê–ù–´ –ü–û–ö–ê –ù–ï –°–û–ó–î–ê–ù–´
                        </div>
                        <div style="color: #aaa;">
                            –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º, –∫—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –∫–ª–∞–Ω!
                        </div>
                    </div>
                `;
                return;
            }
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –∫–ª–∞–Ω—ã –ø–æ —É—Ä–æ–≤–Ω—é (—É–±—ã–≤–∞–Ω–∏–µ)
            const sortedClans = [...clans].sort((a, b) => b.level - a.level);
            
            sortedClans.forEach(clan => {
                const card = document.createElement('div');
                card.className = 'clan-card';
                card.onclick = () => showClanInfo(clan.id);
                
                const isMember = game.clan.id === clan.id;
                const members = clanMembers[clan.id] || [];
                const memberCount = members.length;
                
                card.innerHTML = `
                    <div class="clan-header">
                        <div class="clan-name">
                            <span>üõ°Ô∏è</span>
                            <span>${clan.name}</span>
                            ${clan.isPublic ? 'üåê' : 'üîí'}
                        </div>
                        <div class="clan-level">–£—Ä. ${clan.level}</div>
                    </div>
                    <div class="clan-stats">
                        <div>üë• ${memberCount}/${clan.maxMembers || 50}</div>
                        <div>üí∞ ${formatNumber(clan.totalEarned || 0)} TON</div>
                    </div>
                    <div style="color: #88ccff; margin: 10px 0; font-size: 0.9em;">
                        ${clan.description || '–ë–µ–∑ –æ–ø–∏—Å–∞–Ω–∏—è'}
                    </div>
                    <div style="color: #ffcc00; font-size: 0.8em; margin-bottom: 10px;">
                        üìã ${clan.requirements || '–ë–µ–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π'}
                    </div>
                    <button class="clan-join-btn ${isMember ? (game.clan.role === 'leader' ? 'leader' : 'joined') : ''}" 
                            onclick="event.stopPropagation(); ${isMember ? '' : `joinClan('${clan.id}')`}">
                        ${isMember ? (game.clan.role === 'leader' ? 'üëë –í–´ –õ–ò–î–ï–†' : '‚úÖ –í–´ –í –ö–õ–ê–ù–ï') : 'ü§ù –í–°–¢–£–ü–ò–¢–¨'}
                    </button>
                `;
                
                container.appendChild(card);
            });
        }
        
        function showClanInfo(clanId) {
            const clan = clans.find(c => c.id === clanId);
            if (!clan) return;
            
            const members = clanMembers[clan.id] || [];
            const isLeader = game.clan.id === clanId && game.clan.role === 'leader';
            const isMember = game.clan.id === clanId;
            
            let membersHtml = '';
            members.forEach((member, index) => {
                const isCurrentUser = member.userId === userId;
                membersHtml += `
                    <div class="leaderboard-item" style="padding: 8px 10px;">
                        <div class="player-rank">${index + 1}</div>
                        <div class="player-info">
                            <div class="player-name">
                                ${member.name}
                                ${isCurrentUser ? ' (–í—ã)' : ''}
                                ${member.role === 'leader' ? ' üëë' : ''}
                            </div>
                            <div class="player-clan">${formatNumber(member.contribution || 0)} TON –≤–ª–æ–∂–µ–Ω–æ</div>
                        </div>
                        <div class="player-ton">${formatNumber(member.totalMined || 0)} TON</div>
                    </div>
                `;
            });
            
            document.getElementById('clanModalTitle').textContent = `üõ°Ô∏è ${clan.name}`;
            document.getElementById('clanInfoContent').innerHTML = `
                <div style="margin-bottom: 20px;">
                    <div style="color: #88aaff; margin-bottom: 10px;">üìù –û–ø–∏—Å–∞–Ω–∏–µ:</div>
                    <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                        ${clan.description || '–ë–µ–∑ –æ–ø–∏—Å–∞–Ω–∏—è'}
                    </div>
                    
                    <div style="color: #88aaff; margin-bottom: 10px;">üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:</div>
                    <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                        ${clan.requirements || '–ë–µ–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π'}
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-label">üèÜ –£—Ä–æ–≤–µ–Ω—å –∫–ª–∞–Ω–∞</div>
                            <div class="stat-value">${clan.level}</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">üí∞ –û–±—â–∏–π —Ñ–æ–Ω–¥</div>
                            <div class="stat-value">${formatNumber(clan.totalEarned || 0)} TON</div>
                        </div>
                    </div>
                    
                    <div style="color: #88aaff; margin: 20px 0 10px;">üë• –£—á–∞—Å—Ç–Ω–∏–∫–∏ (${members.length}/${clan.maxMembers || 50}):</div>
                    <div class="leaderboard" style="max-height: 300px; overflow-y: auto;">
                        ${membersHtml || '<div style="padding: 20px; text-align: center; color: #888;">–ù–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</div>'}
                    </div>
                </div>
                
                ${isLeader ? `
                    <div class="modal-buttons">
                        <button class="modal-btn secondary" onclick="manageClan('${clan.id}')">
                            ‚öôÔ∏è –£–ü–†–ê–í–õ–ï–ù–ò–ï
                        </button>
                        <button class="modal-btn danger" onclick="leaveClan('${clan.id}')">
                            üö™ –†–ê–°–ü–£–°–¢–ò–¢–¨
                        </button>
                    </div>
                ` : isMember ? `
                    <div class="modal-buttons">
                        <button class="modal-btn secondary" onclick="contributeToClan('${clan.id}')">
                            üí∞ –í–ù–ï–°–¢–ò –í–ó–ù–û–°
                        </button>
                        <button class="modal-btn danger" onclick="leaveClan('${clan.id}')">
                            üö™ –ü–û–ö–ò–ù–£–¢–¨
                        </button>
                    </div>
                ` : `
                    <button class="tg-btn" onclick="joinClan('${clan.id}')" style="width: 100%;">
                        ü§ù –í–°–¢–£–ü–ò–¢–¨ –í –ö–õ–ê–ù
                    </button>
                `}
            `;
            
            openModal('clanInfoModal');
        }
        
        function confirmCreateClan() {
            const name = document.getElementById('clanNameInput').value.trim();
            const description = document.getElementById('clanDescInput').value.trim();
            const requirements = document.getElementById('clanRequirementsInput').value.trim();
            
            if (!name || name.length < 3 || name.length > 20) {
                showNotification('‚ùå –ù–∞–∑–≤–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç 3 –¥–æ 20 —Å–∏–º–≤–æ–ª–æ–≤', 'error');
                return;
            }
            
            if (game.balance < 1000) {
                showNotification('‚ùå –ù—É–∂–Ω–æ 1000 TON –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∞–Ω–∞', 'error');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ—Ç –ª–∏ —É–∂–µ –∫–ª–∞–Ω–∞ —Å —Ç–∞–∫–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º
            if (clans.some(c => c.name.toLowerCase() === name.toLowerCase())) {
                showNotification('‚ùå –ö–ª–∞–Ω —Å —Ç–∞–∫–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç', 'error');
                return;
            }
            
            game.balance -= 1000;
            
            const newClan = {
                id: 'clan_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
                name: name,
                description: description,
                requirements: requirements,
                leaderId: userId,
                leaderName: userName,
                level: 1,
                totalEarned: 1000,
                maxMembers: 50,
                isPublic: true,
                created: new Date().toISOString(),
                members: [userId]
            };
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞–Ω
            clans.push(newClan);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –ª–∏–¥–µ—Ä–∞ –≤ —É—á–∞—Å—Ç–Ω–∏–∫–∏
            clanMembers[newClan.id] = [{
                userId: userId,
                name: userName,
                role: 'leader',
                joined: new Date().toISOString(),
                contribution: 1000,
                totalMined: game.totalMined
            }];
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–≥—Ä–æ–∫–∞
            game.clan = {
                id: newClan.id,
                name: name,
                role: 'leader',
                joined: true,
                memberSince: new Date().toISOString()
            };
            
            showNotification(`üõ°Ô∏è –ö–ª–∞–Ω "${name}" —Å–æ–∑–¥–∞–Ω!`, 'success');
            updateUI();
            updateClansList();
            saveGame();
            saveClans();
            closeModal('createClanModal');
            
            // –û—á–∏—â–∞–µ–º –ø–æ–ª—è
            document.getElementById('clanNameInput').value = '';
            document.getElementById('clanDescInput').value = '';
            document.getElementById('clanRequirementsInput').value = '';
        }
        
        function joinClan(clanId) {
            if (game.clan.joined) {
                showNotification('‚ùå –í—ã —É–∂–µ —Å–æ—Å—Ç–æ–∏—Ç–µ –≤ –∫–ª–∞–Ω–µ', 'error');
                return;
            }
            
            const clan = clans.find(c => c.id === clanId);
            if (!clan) return;
            
            const members = clanMembers[clan.id] || [];
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –º–µ—Å—Ç–∞
            if (members.length >= (clan.maxMembers || 50)) {
                showNotification('‚ùå –í –∫–ª–∞–Ω–µ –Ω–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã—Ö –º–µ—Å—Ç', 'error');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
            if (clan.requirements) {
                const requiredTon = parseInt(clan.requirements.match(/\d+/)?.[0]) || 0;
                if (game.totalMined < requiredTon) {
                    showNotification(`‚ùå –ù—É–∂–Ω–æ –¥–æ–±—ã—Ç—å –º–∏–Ω–∏–º—É–º ${requiredTon} TON`, 'error');
                    return;
                }
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∏–≥—Ä–æ–∫–∞ –≤ –∫–ª–∞–Ω
            members.push({
                userId: userId,
                name: userName,
                role: 'member',
                joined: new Date().toISOString(),
                contribution: 0,
                totalMined: game.totalMined
            });
            
            clanMembers[clan.id] = members;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–≥—Ä–æ–∫–∞
            game.clan = {
                id: clanId,
                name: clan.name,
                role: 'member',
                joined: true,
                memberSince: new Date().toISOString()
            };
            
            showNotification(`üéâ –í—ã –≤—Å—Ç—É–ø–∏–ª–∏ –≤ –∫–ª–∞–Ω "${clan.name}"!`, 'success');
            updateUI();
            updateClansList();
            saveGame();
            saveClans();
            closeModal('clanInfoModal');
        }
        
        function leaveClan(clanId) {
            if (!game.clan.joined || game.clan.id !== clanId) {
                showNotification('‚ùå –í—ã –Ω–µ —Å–æ—Å—Ç–æ–∏—Ç–µ –≤ —ç—Ç–æ–º –∫–ª–∞–Ω–µ', 'error');
                return;
            }
            
            const clan = clans.find(c => c.id === clanId);
            if (!clan) return;
            
            if (game.clan.role === 'leader') {
                // –õ–∏–¥–µ—Ä –ø–æ–∫–∏–¥–∞–µ—Ç –∫–ª–∞–Ω - —Ä–∞—Å–ø—É—Å–∫–∞–µ–º –∫–ª–∞–Ω
                if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Ä–∞—Å–ø—É—Å—Ç–∏—Ç—å –∫–ª–∞–Ω? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
                    // –£–¥–∞–ª—è–µ–º –∫–ª–∞–Ω
                    const index = clans.findIndex(c => c.id === clanId);
                    clans.splice(index, 1);
                    
                    // –£–¥–∞–ª—è–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
                    delete clanMembers[clanId];
                    
                    // –û–ø–æ–≤–µ—â–∞–µ–º –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
                    showNotification(`üóëÔ∏è –ö–ª–∞–Ω "${clan.name}" —Ä–∞—Å–ø—É—â–µ–Ω`, 'warning');
                } else {
                    return;
                }
            } else {
                // –û–±—ã—á–Ω—ã–π —É—á–∞—Å—Ç–Ω–∏–∫ –ø–æ–∫–∏–¥–∞–µ—Ç –∫–ª–∞–Ω
                const members = clanMembers[clanId] || [];
                const memberIndex = members.findIndex(m => m.userId === userId);
                
                if (memberIndex !== -1) {
                    members.splice(memberIndex, 1);
                    clanMembers[clanId] = members;
                    
                    showNotification(`üëã –í—ã –ø–æ–∫–∏–Ω—É–ª–∏ –∫–ª–∞–Ω "${clan.name}"`, 'warning');
                }
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–≥—Ä–æ–∫–∞
            game.clan = {
                id: null,
                name: '',
                role: null,
                joined: false,
                memberSince: null
            };
            
            updateUI();
            updateClansList();
            saveGame();
            saveClans();
            closeModal('clanInfoModal');
        }
        
        function contributeToClan(clanId) {
            if (!game.clan.joined || game.clan.id !== clanId) {
                showNotification('‚ùå –í—ã –Ω–µ —Å–æ—Å—Ç–æ–∏—Ç–µ –≤ —ç—Ç–æ–º –∫–ª–∞–Ω–µ', 'error');
                return;
            }
            
            const amount = parseInt(prompt('–°–∫–æ–ª—å–∫–æ TON –≤–Ω–µ—Å—Ç–∏ –≤ —Ñ–æ–Ω–¥ –∫–ª–∞–Ω–∞?'));
            if (!amount || amount <= 0 || amount > game.balance) {
                showNotification('‚ùå –ù–µ–≤–µ—Ä–Ω–∞—è —Å—É–º–º–∞', 'error');
                return;
            }
            
            game.balance -= amount;
            
            const clan = clans.find(c => c.id === clanId);
            if (clan) {
                clan.totalEarned = (clan.totalEarned || 0) + amount;
                clan.level = Math.floor(Math.sqrt(clan.totalEarned / 1000)) + 1;
            }
            
            const members = clanMembers[clanId] || [];
            const memberIndex = members.findIndex(m => m.userId === userId);
            if (memberIndex !== -1) {
                members[memberIndex].contribution = (members[memberIndex].contribution || 0) + amount;
            }
            
            showNotification(`üí∞ –í—ã –≤–Ω–µ—Å–ª–∏ ${amount} TON –≤ —Ñ–æ–Ω–¥ –∫–ª–∞–Ω–∞!`, 'success');
            updateUI();
            updateClansList();
            saveGame();
            saveClans();
        }
        
        function manageClan(clanId) {
            showNotification('‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∞–Ω–æ–º –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...', 'warning');
        }
        
        // ============ –¢–û–ü –ò–ì–†–û–ö–ò ============
        function updateTopPlayers() {
            const container = document.getElementById('topPlayers');
            container.innerHTML = '';
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –∏–≥—Ä–æ–∫–æ–≤ –ø–æ –¥–æ–±—ã—á–µ
            const sortedPlayers = [...topPlayers].sort((a, b) => b.totalMined - a.totalMined);
            
            sortedPlayers.slice(0, 10).forEach((player, index) => {
                const item = document.createElement('div');
                item.className = 'leaderboard-item';
                
                let rankClass = 'player-rank';
                if (index === 0) rankClass += ' top1';
                else if (index === 1) rankClass += ' top2';
                else if (index === 2) rankClass += ' top3';
                
                item.innerHTML = `
                    <div class="${rankClass}">${index + 1}</div>
                    <div class="player-info">
                        <div class="player-name">
                            ${player.name}
                            ${player.premium ? '<span class="premium-badge" style="margin-left: 5px; font-size: 0.7em;">PREMIUM</span>' : ''}
                        </div>
                        ${player.clan ? `<div class="player-clan">${player.clan}</div>` : ''}
                    </div>
                    <div class="player-ton">${formatNumber(player.totalMined)} TON</div>
                `;
                
                container.appendChild(item);
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–∑–∏—Ü–∏—é –∏–≥—Ä–æ–∫–∞
            updatePlayerRank();
        }
        
        function updatePlayerInTop() {
            // –ù–∞—Ö–æ–¥–∏–º –∏–≥—Ä–æ–∫–∞ –≤ —Ç–æ–ø–µ
            const playerIndex = topPlayers.findIndex(p => p.userId === userId);
            
            if (playerIndex !== -1) {
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞
                topPlayers[playerIndex] = {
                    ...topPlayers[playerIndex],
                    name: userName,
                    totalMined: game.totalMined,
                    bestPrice: game.bestPrice,
                    premium: game.premium.active,
                    clan: game.clan.name || null
                };
            } else {
                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞
                topPlayers.push({
                    userId: userId,
                    name: userName,
                    totalMined: game.totalMined,
                    bestPrice: game.bestPrice,
                    premium: game.premium.active,
                    clan: game.clan.name || null,
                    joined: new Date().toISOString()
                });
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ø
            saveTopPlayers();
            updatePlayerRank();
        }
        
        function updatePlayerRank() {
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –∏ –Ω–∞—Ö–æ–¥–∏–º –ø–æ–∑–∏—Ü–∏—é
            const sortedPlayers = [...topPlayers].sort((a, b) => b.totalMined - a.totalMined);
            const playerIndex = sortedPlayers.findIndex(p => p.userId === userId);
            
            if (playerIndex !== -1) {
                document.getElementById('playerRank').textContent = '#' + (playerIndex + 1);
            } else {
                document.getElementById('playerRank').textContent = '#' + (sortedPlayers.length + 1);
            }
            
            document.getElementById('totalMined').textContent = formatNumber(game.totalMined) + ' TON';
            document.getElementById('bestResult').textContent = '$' + game.bestPrice.toFixed(2);
        }
        
        // ============ –¢–£–†–ù–ò–†–´ (–æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ============
        let tournamentInterval;
        function startTournamentTimer() {
            if (game.tournament.endTime && Date.now() < game.tournament.endTime) {
                updateTournamentTimer();
                
                if (tournamentInterval) clearInterval(tournamentInterval);
                tournamentInterval = setInterval(updateTournamentTimer, 1000);
            } else {
                game.tournament = {
                    joined: false,
                    score: 0,
                    position: 0,
                    prize: 5000 + Math.floor(Math.random() * 5000),
                    endTime: Date.now() + 24 * 60 * 60 * 1000
                };
                saveGame();
                
                updateTournamentTimer();
                if (tournamentInterval) clearInterval(tournamentInterval);
                tournamentInterval = setInterval(updateTournamentTimer, 1000);
            }
        }
        
        function updateTournamentTimer() {
            if (!game.tournament.endTime) return;
            
            const now = Date.now();
            const timeLeft = game.tournament.endTime - now;
            
            if (timeLeft <= 0) {
                endTournament();
                return;
            }
            
            const hours = Math.floor(timeLeft / (1000 * 60 * 60));
            const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
            
            document.getElementById('tournamentTimer').textContent = 
                `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
        
        function updateTournamentInfo() {
            if (game.tournament.joined) {
                game.tournament.score = game.totalMined;
                const position = 15 + Math.floor(Math.random() * 30);
                game.tournament.position = position;
                
                document.getElementById('tournamentPosition').textContent = '#' + position;
            }
            
            document.getElementById('tournamentPrize').textContent = formatNumber(game.tournament.prize) + ' TON';
            document.getElementById('tournamentPlayers').textContent = 85 + Math.floor(Math.random() * 50);
        }
        
        function joinTournament() {
            if (game.tournament.joined) {
                showNotification('‚úÖ –í—ã —É–∂–µ —É—á–∞—Å—Ç–≤—É–µ—Ç–µ –≤ —Ç—É—Ä–Ω–∏—Ä–µ', 'warning');
                return;
            }
            
            if (game.balance < 50) {
                showNotification('‚ùå –ù—É–∂–Ω–æ 50 TON –¥–ª—è —É—á–∞—Å—Ç–∏—è', 'error');
                return;
            }
            
            game.balance -= 50;
            game.tournament.joined = true;
            game.tournament.score = game.totalMined;
            game.tournament.position = 85 + Math.floor(Math.random() * 30);
            
            showNotification('‚öîÔ∏è –í—ã —É—á–∞—Å—Ç–≤—É–µ—Ç–µ –≤ —Ç—É—Ä–Ω–∏—Ä–µ! –£–¥–∞—á–∏!', 'success');
            updateUI();
            saveGame();
        }
        
        function endTournament() {
            if (game.tournament.joined) {
                const wonPrize = game.tournament.position <= 3 ? game.tournament.prize / (4 - game.tournament.position) : 0;
                
                if (wonPrize > 0) {
                    game.balance += wonPrize;
                    showNotification(`üèÜ –¢–£–†–ù–ò–† –û–ö–û–ù–ß–ï–ù! –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${formatNumber(wonPrize)} TON!`, 'success');
                } else {
                    showNotification('üèÜ –¢—É—Ä–Ω–∏—Ä –æ–∫–æ–Ω—á–µ–Ω. –í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –ø–æ–≤–µ–∑–µ—Ç –±–æ–ª—å—à–µ!', 'warning');
                }
            }
            
            game.tournament = {
                joined: false,
                score: 0,
                position: 0,
                prize: 5000 + Math.floor(Math.random() * 5000),
                endTime: Date.now() + 24 * 60 * 60 * 1000
            };
            
            updateUI();
            saveGame();
        }
        
        // ============ PREMIUM –ò –ü–û–ö–£–ü–ö–ò (–æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ============
        function buyPremium(price) {
            if (!isTelegram) {
                showNotification('‚≠ê Premium –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –≤ Telegram –≤–µ—Ä—Å–∏–∏', 'warning');
                return;
            }
            
            const type = price === 9.99 ? 'pro' : 'vip';
            
            tg.showPopup({
                title: 'üí≥ –û–ü–õ–ê–¢–ê PREMIUM',
                message: `–û–ø–ª–∞—Ç–∏—Ç–µ $${price} –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ Premium ${type.toUpperCase()}`,
                buttons: [
                    {id: 'pay', type: 'default', text: `üí≥ –û–ü–õ–ê–¢–ò–¢–¨ $${price}`},
                    {type: 'cancel'}
                ]
            }, (btnId) => {
                if (btnId === 'pay') {
                    game.premium = {
                        active: true,
                        type: type,
                        expires: Date.now() + 30 * 24 * 60 * 60 * 1000
                    };
                    
                    game.purchases.totalSpent += price;
                    game.purchases.lastPurchase = new Date().toISOString();
                    
                    showNotification(`‚≠ê PREMIUM ${type.toUpperCase()} –ê–ö–¢–ò–í–ò–†–û–í–ê–ù!`, 'premium');
                    updateUI();
                    updatePlayerInTop();
                    saveGame();
                    closeModal('premiumModal');
                }
            });
        }
        
        function buyTonPackage(amount) {
            const price = amount * 2.5;
            const bonus = amount * (amount === 10 ? 0.05 : amount === 50 ? 0.15 : 0.30);
            const total = amount + bonus;
            
            tg.showPopup({
                title: 'üí∞ –ü–û–ö–£–ü–ö–ê TON',
                message: `–ö—É–ø–∏—Ç—å ${amount} TON + ${bonus.toFixed(0)} –±–æ–Ω—É—Å–Ω—ã—Ö TON –∑–∞ $${price}?`,
                buttons: [
                    {id: 'confirm', type: 'default', text: `üí≥ –û–ü–õ–ê–¢–ò–¢–¨ $${price}`},
                    {type: 'cancel'}
                ]
            }, (btnId) => {
                if (btnId === 'confirm') {
                    game.balance += total;
                    game.purchases.tonBought += total;
                    game.purchases.totalSpent += price;
                    game.purchases.lastPurchase = new Date().toISOString();
                    
                    showNotification(`‚úÖ –ö—É–ø–ª–µ–Ω–æ ${total.toFixed(0)} TON!`, 'success');
                    updateUI();
                    updatePlayerInTop();
                    saveGame();
                    closeModal('buyTonModal');
                }
            });
        }
        
        function openPayment() {
            if (!isTelegram) {
                showNotification('üí≥ –û–ø–ª–∞—Ç–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –≤ Telegram', 'warning');
                return;
            }
            
            tg.openInvoice('invoice_url_here', (status) => {
                if (status === 'paid') {
                    showNotification('‚úÖ –û–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ!', 'success');
                }
            });
        }
        
        // ============ –†–ï–§–ï–†–ê–õ–¨–ù–ê–Ø –°–ò–°–¢–ï–ú–ê ============
        function checkReferralParams() {
            const urlParams = new URLSearchParams(window.location.search);
            const ref = urlParams.get('ref');
            
            if (ref && ref !== referralCode) {
                if (!game.referrals.list.includes(ref)) {
                    game.referrals.list.push(ref);
                    game.referrals.count++;
                    game.balance += 100;
                    game.friends++;
                    
                    showNotification('üéâ –í—ã –ø—Ä–∏–≥–ª–∞—à–µ–Ω—ã –ø–æ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–µ! +100 TON', 'success');
                    saveGame();
                    updateReferralInfo();
                }
            }
        }
        
        function updateReferralInfo() {
            if (referralCode) {
                let referralUrl = window.location.href.split('?')[0];
                referralUrl += (referralUrl.includes('?') ? '&' : '?') + 'ref=' + referralCode;
                
                document.getElementById('referralLink').textContent = referralUrl;
            }
            
            document.getElementById('referralCount').textContent = game.referrals.count;
            document.getElementById('referralEarned').textContent = formatNumber(game.referrals.earned) + ' TON';
            
            const listContainer = document.getElementById('referralList');
            listContainer.innerHTML = '';
            
            if (game.referrals.list.length === 0) {
                listContainer.innerHTML = '<div style="color: #888; text-align: center; padding: 10px;">–ü–æ–∫–∞ –Ω–µ—Ç —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤</div>';
            } else {
                game.referrals.list.forEach((ref, index) => {
                    const item = document.createElement('div');
                    item.className = 'leaderboard-item';
                    item.style.padding = '8px 10px';
                    item.innerHTML = `
                        <div class="player-rank">${index + 1}</div>
                        <div class="player-info">
                            <div class="player-name">–†–µ—Ñ–µ—Ä–∞–ª #${index + 1}</div>
                            <div class="player-clan">–ö–æ–¥: ${ref}</div>
                        </div>
                        <div class="player-ton">+100 TON</div>
                    `;
                    listContainer.appendChild(item);
                });
            }
        }
        
        function copyReferralLink() {
            const link = document.getElementById('referralLink').textContent;
            navigator.clipboard.writeText(link)
                .then(() => showNotification('üìã –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!', 'success'))
                .catch(() => showNotification('‚ùå –û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è', 'error'));
        }
        
        // ============ –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ============
        function dailyBonus() {
            const today = new Date().toDateString();
            const lastBonus = localStorage.getItem('lastDailyBonus');
            
            if (lastBonus !== today) {
                let bonus = 500 + (game.level * 100);
                
                if (game.premium.active) {
                    if (game.premium.type === 'pro') bonus *= 2;
                    else if (game.premium.type === 'vip') bonus *= 5;
                }
                
                game.balance += bonus;
                localStorage.setItem('lastDailyBonus', today);
                showNotification(`üéÅ –ï–ñ–ï–î–ù–ï–í–ù–´–ô –ë–û–ù–£–°: ${formatNumber(bonus)} TON!`, 'success');
                updateUI();
                updatePlayerInTop();
                saveGame();
            } else {
                showNotification('üéÅ –ë–æ–Ω—É—Å —É–∂–µ –ø–æ–ª—É—á–µ–Ω —Å–µ–≥–æ–¥–Ω—è!', 'warning');
            }
        }
        
        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(tabName + 'Tab').classList.add('active');
            event.target.classList.add('active');
        }
        
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        function updateUI() {
            // –¶–µ–Ω–∞ –∏ –≥—Ä–∞—Ñ–∏–∫
            document.getElementById('price').textContent = '$' + game.price.toFixed(2);
            document.getElementById('balance').textContent = formatNumber(game.balance) + ' TON';
            document.getElementById('hashrate').textContent = formatNumber(game.hashrate) + ' GH/s';
            document.getElementById('friends').textContent = game.friends;
            document.getElementById('level').textContent = game.level;
            
            // –†–æ—Å—Ç —Ü–µ–Ω—ã
            let growth = 0.01 + (game.upgrades.gpu * 0.003);
            if (game.upgrades.bot) growth *= 2;
            if (game.premium.active) growth *= (game.premium.type === 'pro' ? 3 : 5);
            if (game.upgrades.satellite) growth *= 10;
            document.getElementById('growthRate').textContent = growth.toFixed(3);
            
            // –ì—Ä–∞—Ñ–∏–∫
            const maxPrice = 1000;
            const chartWidth = Math.min(20, Math.floor((game.price / maxPrice) * 20));
            document.getElementById('chart').textContent = 
                '[' + '‚ñÜ'.repeat(chartWidth) + ' '.repeat(20 - chartWidth) + ']';
            
            // –£–ª—É—á—à–µ–Ω–∏—è
            document.getElementById('gpuCount').textContent = game.upgrades.gpu;
            document.getElementById('farmCount').textContent = game.upgrades.farm;
            document.getElementById('botCount').textContent = game.upgrades.bot ? '‚úì' : '0';
            document.getElementById('exchangeCount').textContent = game.upgrades.exchange ? '‚úì' : '0';
            document.getElementById('satelliteCount').textContent = game.upgrades.satellite ? '‚úì' : '0';
            
            document.getElementById('gpuPrice').textContent = formatNumber(Math.floor(50 * Math.pow(1.25, game.upgrades.gpu))) + ' TON';
            document.getElementById('farmPrice').textContent = formatNumber(Math.floor(250 * Math.pow(1.3, game.upgrades.farm))) + ' TON';
            document.getElementById('botPrice').textContent = '500 TON';
            document.getElementById('exchangePrice').textContent = '2,000 TON';
            document.getElementById('satellitePrice').textContent = '10,000 TON';
            
            // –ê–≤—Ç–æ-–¥–æ–±—ã—á–∞
            let autoPower = game.upgrades.farm * 25;
            if (game.upgrades.exchange) autoPower *= 3;
            if (game.upgrades.satellite) autoPower *= 10;
            if (game.premium.active) autoPower *= 2;
            document.getElementById('autoIncome').textContent = formatNumber(autoPower) + '/—Å–µ–∫';
        }
        
        function updateGoal() {
            const progress = (game.price / 1000) * 100;
            document.getElementById('goalProgress').textContent = progress.toFixed(1) + '%';
            document.getElementById('goalBar').style.width = Math.min(100, progress) + '%';
            
            if (game.price >= 1000 && !game.achievedGoal) {
                game.achievedGoal = true;
                game.balance += 10000;
                showNotification('üèÜ –ü–û–ë–ï–î–ê! –í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ $1000! +10,000 TON!', 'success');
                
                if (isTelegram) {
                    tg.showAlert('üéâ –í–´ –õ–ï–ì–ï–ù–î–ê! –î–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ –≥–ª–∞–≤–Ω–∞—è —Ü–µ–ª—å $1000!');
                }
            }
        }
        
        function checkRandomEvents() {
            if (Math.random() < 0.03) {
                const pump = 0.1 + (game.upgrades.gpu * 0.01);
                game.price *= (1 + pump);
                showNotification(`üìà –ü–ê–ú–ü! –¶–µ–Ω–∞ +${(pump*100).toFixed(1)}%!`, 'success');
            }
            
            if (Math.random() < 0.02) {
                const news = [
                    { text: 'üì∞ TON –≤—ã—Ä–æ—Å –Ω–∞ 15%!', effect: 1.15 },
                    { text: '‚ö†Ô∏è –ö–æ—Ä—Ä–µ–∫—Ü–∏—è —Ä—ã–Ω–∫–∞ -5%', effect: 0.95 },
                    { text: 'üöÄ –ö—Ä—É–ø–Ω–∞—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è –≤ TON!', effect: 1.25 },
                    { text: 'üìâ –ü–∞–Ω–∏–∫–∞ –Ω–∞ —Ä—ã–Ω–∫–µ -8%', effect: 0.92 }
                ];
                
                const event = news[Math.floor(Math.random() * news.length)];
                game.price *= event.effect;
                showNotification(event.text, event.effect > 1 ? 'success' : 'warning');
            }
        }
        
        function showNotification(text, type = 'success') {
            const notif = document.getElementById('notification');
            notif.textContent = text;
            notif.className = 'notification';
            
            if (type === 'error') {
                notif.classList.add('error');
            } else if (type === 'warning') {
                notif.classList.add('warning');
            } else if (type === 'premium') {
                notif.classList.add('premium');
            }
            
            notif.style.display = 'block';
            
            setTimeout(() => {
                notif.style.display = 'none';
            }, 3000);
        }
        
        function formatNumber(num) {
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
            return Math.floor(num);
        }
        
        // ============ –ó–ê–ü–£–°–ö –ò–ì–†–´ ============
        window.addEventListener('DOMContentLoaded', () => {
            loadGame();
            checkReferralParams();
        });
        
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) {
                e.target.style.display = 'none';
            }
        });
    </script>
</body>
</html>
