<!DOCTYPE html>
<html>
<head>
    <title>TON Miner - Telegram</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            background: linear-gradient(135deg, #0a0a0a, #1a1a2e);
            color: white;
            font-family: Arial, sans-serif;
            padding: 20px;
            text-align: center;
            margin: 0;
            min-height: 100vh;
        }
        
        .container {
            max-width: 500px;
            margin: 0 auto;
            background: rgba(30, 30, 46, 0.9);
            padding: 25px;
            border-radius: 20px;
            border: 2px solid #00ffff;
            box-shadow: 0 10px 30px rgba(0, 255, 255, 0.2);
        }
        
        h1 {
            color: #00ffff;
            margin-bottom: 20px;
            font-size: 2em;
            text-shadow: 0 0 10px #00ffff;
        }
        
        .price {
            font-size: 60px;
            color: #00ff88;
            font-weight: bold;
            margin: 30px 0;
            text-shadow: 0 0 15px #00ff88;
            transition: transform 0.3s;
        }
        
        .main-btn {
            background: linear-gradient(45deg, #ff0088, #8800ff);
            color: white;
            border: none;
            padding: 25px;
            font-size: 24px;
            font-weight: bold;
            border-radius: 15px;
            cursor: pointer;
            width: 100%;
            margin: 20px 0;
            transition: transform 0.2s;
            box-shadow: 0 8px 20px rgba(255, 0, 136, 0.4);
        }
        
        .main-btn:active {
            transform: scale(0.95);
        }
        
        .stats {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: left;
            font-size: 1.2em;
        }
        
        .tg-btn {
            background: linear-gradient(45deg, #0088cc, #0066aa);
            color: white;
            border: none;
            padding: 20px;
            font-size: 18px;
            border-radius: 15px;
            cursor: pointer;
            width: 100%;
            margin: 10px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .tg-btn.ton {
            background: linear-gradient(45deg, #ffcc00, #ff9900);
        }
        
        .tg-btn.share {
            background: linear-gradient(45deg, #00cc88, #00ffaa);
        }
        
        .player-info {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: left;
        }
        
        .upgrade {
            background: rgba(0, 100, 255, 0.2);
            border: 2px solid #0088ff;
            border-radius: 15px;
            padding: 15px;
            margin: 10px 0;
            cursor: pointer;
            text-align: left;
            transition: all 0.3s;
        }
        
        .upgrade:active {
            background: rgba(0, 100, 255, 0.4);
            transform: translateX(5px);
        }
        
        .achievement-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 10px;
            opacity: 0.6;
        }
        
        .achievement-item.unlocked {
            background: rgba(0,255,100,0.2);
            border-color: #00ff88;
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ TON MINER</h1>
        <div class="player-info">
            <div>üë§ –ò–≥—Ä–æ–∫: <span id="playerName">–ó–∞–≥—Ä—É–∑–∫–∞...</span></div>
            <div>üí∞ –ë–∞–ª–∞–Ω—Å: <span id="balance">0</span> TON</div>
            <div>üìä –ö–ª–∏–∫–æ–≤: <span id="clicks">0</span></div>
        </div>
        
        <div class="price" id="price">$1.00</div>
        
        <button class="main-btn" onclick="clickTon()">
            üöÄ –ù–ê–ö–ê–ß–ê–¢–¨ TON
        </button>
        
        <div class="stats">
            <p>‚ö° –•–µ—à—Ä–µ–π—Ç: <span id="hashrate">1</span> GH/s</p>
            <p>üìà –†–æ—Å—Ç: +<span id="growth">0.01</span>/–∫–ª–∏–∫</p>
            <p>üë• –î—Ä—É–∑–µ–π: <span id="friends">0</span></p>
            <p>üéØ –£—Ä–æ–≤–µ–Ω—å: <span id="level">1</span></p>
        </div>
        
        <div class="upgrade" onclick="buyUpgrade('gpu')">
            <div style="font-weight: bold; color: #88ccff;">üíª –í–∏–¥–µ–æ–∫–∞—Ä—Ç–∞</div>
            <div style="font-size: 0.9em;">+5 GH/s, +0.3% –∫ —Ü–µ–Ω–µ</div>
            <div style="color: #ffcc00; font-weight: bold; margin-top: 5px;">
                –¶–µ–Ω–∞: <span id="gpuPrice">50</span> TON
            </div>
        </div>
        
        <div class="upgrade" onclick="buyUpgrade('farm')">
            <div style="font-weight: bold; color: #88ccff;">üåê –ú–∞–π–Ω–∏–Ω–≥-—Ñ–µ—Ä–º–∞</div>
            <div style="font-size: 0.9em;">+25 GH/s –∞–≤—Ç–æ-–¥–æ–±—ã—á–∏</div>
            <div style="color: #ffcc00; font-weight: bold; margin-top: 5px;">
                –¶–µ–Ω–∞: <span id="farmPrice">250</span> TON
            </div>
        </div>
        
        <button class="tg-btn ton" onclick="buyTon()">
            üí∞ –ö–£–ü–ò–¢–¨ TON
        </button>
        
        <button class="tg-btn share" onclick="shareGame()">
            üë• –ü–†–ò–ì–õ–ê–°–ò–¢–¨ –î–†–£–ì–ê
        </button>
        
        <button class="tg-btn" onclick="dailyBonus()">
            üéÅ –ï–ñ–ï–î–ù–ï–í–ù–´–ô –ë–û–ù–£–°
        </button>
        
        <!-- –ë–õ–û–ö –¶–ï–õ–ò $1000 -->
        <div style="margin-top: 30px; padding: 20px; background: rgba(255,100,100,0.1); border-radius: 15px; border: 2px solid #ff4444;">
            <div style="color: #ff4444; font-weight: bold; font-size: 1.2em; margin-bottom: 10px;">
                üèÜ –ì–õ–ê–í–ù–ê–Ø –¶–ï–õ–¨: $1000
            </div>
            <div style="color: #ff8888; margin-bottom: 10px;">
                –î–æ—Å—Ç–∏–≥–Ω–∏ $1000 –∏ –ø–æ–ª—É—á–∏ —Ä–µ–∞–ª—å–Ω—ã–µ TON –Ω–∞ –∫–æ—à–µ–ª—ë–∫!
            </div>
            <div style="background: rgba(255,255,255,0.1); border-radius: 10px; padding: 10px; margin-bottom: 10px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                    <span>–ü—Ä–æ–≥—Ä–µ—Å—Å:</span>
                    <span id="goalProgress">0.1%</span>
                </div>
                <div style="height: 10px; background: rgba(255,255,255,0.2); border-radius: 5px; overflow: hidden;">
                    <div id="goalBar" style="height: 100%; background: linear-gradient(90deg, #ff4444, #ff9900); width: 0.1%; transition: width 0.5s;"></div>
                </div>
            </div>
            <div style="color: #ffcc00; font-size: 0.9em;">
                üéÅ –ù–∞–≥—Ä–∞–¥–∞: 10000 TON + 10 —Ä–µ–∞–ª—å–Ω—ã—Ö TON
            </div>
        </div>
        
        <!-- –ë–õ–û–ö –î–û–°–¢–ò–ñ–ï–ù–ò–ô -->
        <div style="margin-top: 20px; padding: 20px; background: rgba(0,100,255,0.1); border-radius: 15px; border: 1px solid #0088ff;">
            <div style="color: #00aaff; font-weight: bold; font-size: 1.2em; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                <span>üéØ –î–û–°–¢–ò–ñ–ï–ù–ò–Ø</span>
                <span style="font-size: 0.8em; background: #00aaff; color: white; padding: 2px 8px; border-radius: 10px;" id="achievementsCount">0/15</span>
            </div>
            
            <div id="achievementsList" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                <!-- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>
        
        <!-- –ë–õ–û–ö –°–õ–û–ñ–ù–û–°–¢–ò -->
        <div style="margin-top: 20px; padding: 15px; background: rgba(100,0,255,0.1); border-radius: 15px; border: 1px solid #8800ff;">
            <div style="color: #aa00ff; font-weight: bold; margin-bottom: 10px;">‚ö° –°–õ–û–ñ–ù–û–°–¢–¨ –ò–ì–†–´</div>
            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                <span>–£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:</span>
                <span id="difficultyLevel">–ù–û–í–ò–ß–û–ö</span>
            </div>
            <div style="display: flex; justify-content: space-between;">
                <span>–ú–Ω–æ–∂–∏—Ç–µ–ª—å —Ü–µ–Ω:</span>
                <span id="priceMultiplier">x1.0</span>
            </div>
        </div>
        
        <div style="margin-top: 30px; font-size: 0.9em; color: #88aaff;">
            –ò–≥—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ –≤–∞—à–µ–º Telegram –∞–∫–∫–∞—É–Ω—Ç–µ
        </div>
    </div>

    <script>
        // ============ TELEGRAM ============
        let tg = window.Telegram.WebApp;
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram
        tg.expand();
        tg.ready();
        tg.enableClosingConfirmation();
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const user = tg.initDataUnsafe.user;
        if (user) {
            document.getElementById('playerName').textContent = user.first_name || '–ò–≥—Ä–æ–∫';
        }
        
        // ============ –ò–ì–†–ê ============
        let game = {
            price: 1.00,
            balance: 0,
            hashrate: 1,
            friends: 0,
            level: 1,
            totalClicks: 0,
            upgrades: { gpu: 0, farm: 0 },
            achievements: {}
        };
        
        // ============ –î–û–°–¢–ò–ñ–ï–ù–ò–Ø ============
        const achievements = [
            { id: 'first_5', name: '–ù–æ–≤–∏—á–æ–∫', desc: '–î–æ—Å—Ç–∏–≥–Ω—É—Ç—å $5', goal: 5, reward: 100, emoji: 'üë∂', unlocked: false },
            { id: 'first_50', name: '–ò–Ω–≤–µ—Å—Ç–æ—Ä', desc: '–î–æ—Å—Ç–∏–≥–Ω—É—Ç—å $50', goal: 50, reward: 500, emoji: 'üíº', unlocked: false },
            { id: 'first_100', name: '–¢—Ä–µ–π–¥–µ—Ä', desc: '–î–æ—Å—Ç–∏–≥–Ω—É—Ç—å $100', goal: 100, reward: 1000, emoji: 'üìà', unlocked: false },
            { id: 'first_500', name: '–ö—Ä–∏–ø—Ç–æ–±–æ—Å—Å', desc: '–î–æ—Å—Ç–∏–≥–Ω—É—Ç—å $500', goal: 500, reward: 5000, emoji: 'üëë', unlocked: false },
            { id: 'legend_1000', name: 'LEGEND', desc: '–î–æ—Å—Ç–∏–≥–Ω—É—Ç—å $1000', goal: 1000, reward: 10000, emoji: 'üèÜ', unlocked: false },
            { id: 'friend_5', name: '–°–æ—Ü–∏–∞–ª—å–Ω—ã–π', desc: '–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å 5 –¥—Ä—É–∑–µ–π', goal: 5, reward: 'Premium', emoji: 'üë•', unlocked: false, type: 'friends' },
            { id: 'balance_10k', name: '–ú–∞–≥–Ω–∞—Ç', desc: '–ó–∞—Ä–∞–±–æ—Ç–∞—Ç—å 10000 TON', goal: 10000, reward: 'x2 –∫–æ –≤—Å–µ–º—É', emoji: 'üí∞', unlocked: false, type: 'balance' },
            { id: 'clicks_1k', name: '–ù–µ—É—Ç–æ–º–∏–º—ã–π', desc: '–°–¥–µ–ª–∞—Ç—å 1000 –∫–ª–∏–∫–æ–≤', goal: 1000, reward: '–ê–≤—Ç–æ-–∫–ª–∏–∫–µ—Ä', emoji: '‚ö°', unlocked: false, type: 'clicks' },
            { id: 'farm_10', name: '–§–µ—Ä–º–µ—Ä', desc: '–ö—É–ø–∏—Ç—å 10 —Ñ–µ—Ä–º', goal: 10, reward: 'x3 –∞–≤—Ç–æ-–¥–æ–±—ã—á–∞', emoji: 'üåæ', unlocked: false, type: 'farms' },
            { id: 'gpu_20', name: '–ú–∞—Å—Ç–µ—Ä GPU', desc: '–ö—É–ø–∏—Ç—å 20 –≤–∏–¥–µ–æ–∫–∞—Ä—Ç', goal: 20, reward: 'x2 –∫ —Ü–µ–Ω–µ', emoji: 'üíª', unlocked: false, type: 'gpus' },
            { id: 'streak_7', name: '–í–µ—Ç–µ—Ä–∞–Ω', desc: '–ò–≥—Ä–∞—Ç—å 7 –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥', goal: 7, reward: '–°—Ç–∞—Ç—É—Å', emoji: 'üéñÔ∏è', unlocked: false, type: 'streak' },
            { id: 'fast_100', name: '–°–∫–æ—Ä–æ—Å—Ç—å', desc: '–î–æ—Å—Ç–∏–≥–Ω—É—Ç—å $100 –∑–∞ 1 —á–∞—Å', goal: 100, reward: '–ë—É—Å—Ç', emoji: 'üöÄ', unlocked: false, type: 'speed' },
            { id: 'rich_50k', name: '–ë–æ–≥–∞—á', desc: '–ù–∞–∫–æ–ø–∏—Ç—å 50000 TON', goal: 50000, reward: 'x5 –±–∞–ª–∞–Ω—Å', emoji: 'üíé', unlocked: false, type: 'rich' },
            { id: 'pump_10x', name: '–ü–∞–º–ø–µ—Ä', desc: '–£–≤–µ–ª–∏—á–∏—Ç—å —Ü–µ–Ω—É –≤ 10 —Ä–∞–∑', goal: 10, reward: '–ú–µ–≥–∞-–±—É—Å—Ç', emoji: 'üìä', unlocked: false, type: 'multiplier' },
            { id: 'complete_all', name: '–ë–û–ì TON', desc: '–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è', goal: 14, reward: '–í–ï–ß–ù–ê–Ø –°–õ–ê–í–ê', emoji: 'üëë', unlocked: false, type: 'all' }
        ];
        
        // ============ –°–õ–û–ñ–ù–û–°–¢–¨ ============
        const difficultyLevels = [
            { name: '–ù–û–í–ò–ß–û–ö', multiplier: 1.0, minPrice: 1, color: '#00ff88' },
            { name: '–û–ü–´–¢–ù–´–ô', multiplier: 1.5, minPrice: 50, color: '#00aaff' },
            { name: '–ü–†–û–§–ï–°–°–ò–û–ù–ê–õ', multiplier: 2.0, minPrice: 200, color: '#aa00ff' },
            { name: '–≠–ö–°–ü–ï–†–¢', multiplier: 3.0, minPrice: 500, color: '#ffaa00' },
            { name: '–õ–ï–ì–ï–ù–î–ê', multiplier: 5.0, minPrice: 1000, color: '#ff4444' }
        ];
        
        // ============ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ============
        function initGame() {
            // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ Telegram Cloud
            tg.CloudStorage.getItem('tonGame', (err, data) => {
                if (data) {
                    try {
                        const saved = JSON.parse(data);
                        game = { ...game, ...saved };
                    } catch(e) {
                        console.log('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏');
                    }
                }
                updateUI();
                initAchievements();
                updateGoal();
                updateDifficulty();
            });
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ-—Ñ–µ—Ä–º—É –µ—Å–ª–∏ –µ—Å—Ç—å
            if (game.upgrades.farm > 0) {
                startAutoFarm();
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã
            setInterval(() => {
                checkAchievements();
                updateGoal();
                updateDifficulty();
            }, 3000);
        }
        
        // ============ –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò ============
        function clickTon() {
            game.totalClicks++;
            
            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ü–µ–Ω—É
            let increase = 0.01;
            increase += game.upgrades.gpu * 0.003;
            game.price += increase;
            
            // –î–æ–±—ã–≤–∞–µ–º TON
            game.balance += game.hashrate;
            
            updateUI();
            saveGame();
            checkAchievements();
            
            // –ê–Ω–∏–º–∞—Ü–∏—è
            document.getElementById('price').style.transform = 'scale(1.1)';
            setTimeout(() => document.getElementById('price').style.transform = 'scale(1)', 100);
            
            // –°–ª—É—á–∞–π–Ω—ã–π –ø–∞–º–ø
            if (Math.random() < 0.05) {
                game.price *= 1.1;
                tg.showAlert('üìà –ü–ê–ú–ü! –¶–µ–Ω–∞ +10%!');
            }
        }
        
        function buyUpgrade(type) {
            let price = 0;
            let message = '';
            
            if (type === 'gpu') {
                price = Math.floor(50 * Math.pow(1.2, game.upgrades.gpu));
                if (game.balance >= price) {
                    game.balance -= price;
                    game.upgrades.gpu++;
                    game.hashrate += 5;
                    message = 'üíª –í–∏–¥–µ–æ–∫–∞—Ä—Ç–∞ –∫—É–ø–ª–µ–Ω–∞! +5 GH/s';
                }
            } else if (type === 'farm') {
                price = Math.floor(250 * Math.pow(1.3, game.upgrades.farm));
                if (game.balance >= price) {
                    game.balance -= price;
                    game.upgrades.farm++;
                    message = 'üåê –§–µ—Ä–º–∞ –∫—É–ø–ª–µ–Ω–∞! –ó–∞–ø—É—â–µ–Ω–∞ –∞–≤—Ç–æ-–¥–æ–±—ã—á–∞';
                    startAutoFarm();
                }
            }
            
            if (message) {
                tg.showAlert(message);
                updateUI();
                saveGame();
                checkAchievements();
            } else if (price > 0 && game.balance < price) {
                tg.showAlert(`‚ùå –ù—É–∂–Ω–æ –µ—â—ë ${Math.ceil(price - game.balance)} TON`);
            }
        }
        
        // ============ TELEGRAM –§–£–ù–ö–¶–ò–ò ============
        function buyTon() {
            tg.showPopup({
                title: '–ö—É–ø–∏—Ç—å TON',
                message: '–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ:',
                buttons: [
                    {id: 'buy100', type: 'default', text: '100 TON - 0.5 TON'},
                    {id: 'buy500', type: 'default', text: '500 TON - 2 TON'},
                    {id: 'buy1000', type: 'default', text: '1000 TON - 4 TON'},
                    {type: 'cancel'}
                ]
            }, (btnId) => {
                if (btnId === 'buy100') {
                    game.balance += 100;
                    tg.showAlert('‚úÖ –ö—É–ø–ª–µ–Ω–æ 100 TON!');
                    updateUI();
                    saveGame();
                } else if (btnId === 'buy500') {
                    game.balance += 500;
                    tg.showAlert('‚úÖ –ö—É–ø–ª–µ–Ω–æ 500 TON!');
                    updateUI();
                    saveGame();
                } else if (btnId === 'buy1000') {
                    game.balance += 1000;
                    tg.showAlert('‚úÖ –ö—É–ø–ª–µ–Ω–æ 1000 TON!');
                    updateUI();
                    saveGame();
                }
            });
        }
        
        function shareGame() {
            const url = window.location.href;
            const text = 'üéÆ –ö–∞—á–∞–π TON –¥–æ –ª—É–Ω—ã –≤ TON Miner! –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è!';
            
            tg.shareUrl(url, text, (shared) => {
                if (shared) {
                    game.friends++;
                    game.balance += 100;
                    tg.showAlert('üéâ +100 TON –∑–∞ –¥—Ä—É–≥–∞!');
                    updateUI();
                    saveGame();
                    checkAchievements();
                }
            });
        }
        
        function dailyBonus() {
            const today = new Date().toDateString();
            const lastBonus = localStorage.getItem('lastBonus');
            
            if (lastBonus !== today) {
                const bonus = 100 + game.level * 20;
                game.balance += bonus;
                localStorage.setItem('lastBonus', today);
                tg.showAlert(`üéÅ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å: ${bonus} TON!`);
                updateUI();
                saveGame();
            } else {
                tg.showAlert('üéÅ –ë–æ–Ω—É—Å —É–∂–µ –ø–æ–ª—É—á–µ–Ω —Å–µ–≥–æ–¥–Ω—è! –ó–∞–≤—Ç—Ä–∞ –±—É–¥–µ—Ç –Ω–æ–≤—ã–π.');
            }
        }
        
        // ============ –î–û–°–¢–ò–ñ–ï–ù–ò–Ø ============
        function initAchievements() {
            const saved = tg.CloudStorage.getItem('tonAchievements');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    achievements.forEach(ach => {
                        if (data[ach.id]) ach.unlocked = true;
                    });
                } catch(e) {}
            }
            updateAchievementsUI();
        }
        
        function checkAchievements() {
            let changed = false;
            let unlockedCount = 0;
            
            achievements.forEach(ach => {
                if (ach.unlocked) {
                    unlockedCount++;
                    return;
                }
                
                let progress = 0;
                switch(ach.type) {
                    case 'friends': progress = game.friends; break;
                    case 'balance': progress = game.balance; break;
                    case 'clicks': progress = game.totalClicks; break;
                    case 'farms': progress = game.upgrades.farm; break;
                    case 'gpus': progress = game.upgrades.gpu; break;
                    case 'streak': progress = getStreakDays(); break;
                    case 'speed': progress = checkSpeedRun(); break;
                    case 'rich': progress = game.balance; break;
                    case 'multiplier': progress = game.price / 1; break;
                    case 'all': progress = unlockedCount; break;
                    default: progress = game.price; break;
                }
                
                if (progress >= ach.goal) {
                    ach.unlocked = true;
                    changed = true;
                    unlockedCount++;
                    
                    // –í—ã–¥–∞–µ–º –Ω–∞–≥—Ä–∞–¥—É
                    if (typeof ach.reward === 'number') {
                        game.balance += ach.reward;
                        tg.showAlert(`üèÜ "${ach.name}"! +${ach.reward} TON!`);
                    } else {
                        tg.showAlert(`üèÜ "${ach.name}"! ${ach.reward}!`);
                    }
                    
                    // –û—Å–æ–±—ã–µ –Ω–∞–≥—Ä–∞–¥—ã
                    if (ach.id === 'legend_1000') {
                        tg.showAlert('üéâ –í–´ –õ–ï–ì–ï–ù–î–ê! –î–æ—Å—Ç–∏–≥–ª–∏ $1000! –ü–æ–ª—É—á–∞–µ—Ç–µ 10 —Ä–µ–∞–ª—å–Ω—ã—Ö TON!');
                    }
                }
            });
            
            if (changed) {
                saveAchievements();
                updateAchievementsUI();
            }
        }
        
        function updateAchievementsUI() {
            const container = document.getElementById('achievementsList');
            const countElement = document.getElementById('achievementsCount');
            
            if (!container) return;
            
            container.innerHTML = '';
            let unlockedCount = 0;
            
            achievements.forEach(ach => {
                if (ach.unlocked) unlockedCount++;
                
                const div = document.createElement('div');
                div.className = `achievement-item ${ach.unlocked ? 'unlocked' : ''}`;
                div.innerHTML = `
                    <div style="font-size: 1.5em; margin-bottom: 5px;">${ach.emoji}</div>
                    <div style="font-weight: bold; font-size: 0.9em;">${ach.name}</div>
                    <div style="font-size: 0.7em; color: #888; margin: 3px 0;">${ach.desc}</div>
                    <div style="font-size: 0.7em; color: #ffcc00;">${typeof ach.reward === 'number' ? `+${ach.reward} TON` : ach.reward}</div>
                `;
                
                container.appendChild(div);
            });
            
            if (countElement) {
                countElement.textContent = `${unlockedCount}/${achievements.length}`;
            }
        }
        
        function saveAchievements() {
            const data = {};
            achievements.forEach(ach => {
                if (ach.unlocked) data[ach.id] = true;
            });
            tg.CloudStorage.setItem('tonAchievements', JSON.stringify(data));
        }
        
        // ============ –¶–ï–õ–¨ $1000 ============
        function updateGoal() {
            const progress = (game.price / 1000) * 100;
            const progressElement = document.getElementById('goalProgress');
            const barElement = document.getElementById('goalBar');
            
            if (progressElement) {
                progressElement.textContent = `${Math.min(100, progress.toFixed(1))}%`;
            }
            
            if (barElement) {
                barElement.style.width = `${Math.min(100, progress)}%`;
            }
        }
        
        // ============ –°–õ–û–ñ–ù–û–°–¢–¨ ============
        function updateDifficulty() {
            const level = getDifficultyLevel();
            const levelElement = document.getElementById('difficultyLevel');
            const multiplierElement = document.getElementById('priceMultiplier');
            
            if (levelElement) {
                levelElement.textContent = level.name;
                levelElement.style.color = level.color;
            }
            
            if (multiplierElement) {
                multiplierElement.textContent = `x${level.multiplier}`;
            }
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º –º–Ω–æ–∂–∏—Ç–µ–ª—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
            const baseHashrate = 1 + (game.upgrades.gpu * 5);
            game.hashrate = baseHashrate * level.multiplier;
        }
        
        function getDifficultyLevel() {
            for (let i = difficultyLevels.length - 1; i >= 0; i--) {
                if (game.price >= difficultyLevels[i].minPrice) {
                    return difficultyLevels[i];
                }
            }
            return difficultyLevels[0];
        }
        
        // ============ –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï ============
        function getStreakDays() {
            const lastPlay = localStorage.getItem('lastPlayDate');
            const today = new Date().toDateString();
            
            if (lastPlay === today) {
                return parseInt(localStorage.getItem('playStreak') || '0');
            } else if (lastPlay === getYesterday()) {
                const streak = parseInt(localStorage.getItem('playStreak') || '0') + 1;
                localStorage.setItem('playStreak', streak.toString());
                localStorage.setItem('lastPlayDate', today);
                return streak;
            } else {
                localStorage.setItem('playStreak', '1');
                localStorage.setItem('lastPlayDate', today);
                return 1;
            }
        }
        
        function getYesterday() {
            const date = new Date();
            date.setDate(date.getDate() - 1);
            return date.toDateString();
        }
        
        function checkSpeedRun() {
            const startTime = localStorage.getItem('gameStartTime');
            if (!startTime) {
                localStorage.setItem('gameStartTime', Date.now().toString());
                return 0;
            }
            
            const hoursPlayed = (Date.now() - parseInt(startTime)) / (1000 * 60 * 60);
            return game.price >= 100 && hoursPlayed <= 1 ? 100 : 0;
        }
        
        // ============ –ê–í–¢–û-–§–ï–†–ú–ê ============
        let autoFarmInterval;
        function startAutoFarm() {
            if (autoFarmInterval) clearInterval(autoFarmInterval);
            
            autoFarmInterval = setInterval(() => {
                if (game.upgrades.farm > 0) {
                    game.balance += game.upgrades.farm * 25;
                    updateUI();
                    saveGame();
                }
            }, 1000);
        }
        
        // ============ –û–ë–ù–û–í–õ–ï–ù–ò–ï –ò–ù–¢–ï–†–§–ï–ô–°–ê ============
        function updateUI() {
            document.getElementById('price').textContent = '$' + game.price.toFixed(2);
            document.getElementById('balance').textContent = Math.floor(game.balance);
            document.getElementById('hashrate').textContent = game.hashrate.toFixed(1);
            document.getElementById('friends').textContent = game.friends;
            document.getElementById('level').textContent = game.level;
            document.getElementById('clicks').textContent = game.totalClicks;
            document.getElementById('gpuPrice').textContent = Math.floor(50 * Math.pow(1.2, game.upgrades.gpu));
            document.getElementById('farmPrice').textContent = Math.floor(250 * Math.pow(1.3, game.upgrades.farm));
        }
        
        // ============ –°–û–•–†–ê–ù–ï–ù–ò–ï ============
        function saveGame() {
            tg.CloudStorage.setItem('tonGame', JSON.stringify(game));
        }
        
        // ============ –ó–ê–ü–£–°–ö ============
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>
